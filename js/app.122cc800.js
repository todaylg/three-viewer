(function(e){function t(t){for(var i,a,s=t[0],l=t[1],c=t[2],d=0,h=[];d<s.length;d++)a=s[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&h.push(o[a][0]),o[a]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);u&&u(t);while(h.length)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],i=!0,s=1;s<n.length;s++){var l=n[s];0!==o[l]&&(i=!1)}i&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var i={},o={app:0},r=[];function a(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=i,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/three-viewer/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},3468:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"isLoading",attrs:{id:"wrapper"}},[n("div",{attrs:{id:"canvasContainer"}}),n("p",{staticClass:"loadingText"},[e._v("Loading...")]),n("main",{directives:[{name:"show",rawName:"v-show",value:e.openImportPage,expression:"openImportPage"}],staticClass:"dropWrap"},[n("div",{staticClass:"dropzone"},[n("div",{staticClass:"innerArea"},[e._m(0),n("div",{staticClass:"btnArea"},[n("div",{staticClass:"uploadBtn"},[n("input",{attrs:{type:"file",name:"file-input[]",id:"file-input",multiple:""}}),n("label",{attrs:{for:"file-input"}},[n("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"17",viewBox:"0 0 20 17"}},[n("path",{attrs:{d:"M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z"}})]),n("span",[e._v("Upload")])])]),n("div",{staticClass:"uploadBtn",on:{click:e.loadDefaultMode}},[n("span",[e._v("Defalut(3.5MB)")])])])])])])])},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"placeholder"},[n("p",[e._v("Please drag the glTF file or folder (zip supported) to this page")])])}],a=(n("c0b6"),n("d4ec")),s=n("bee2"),l=n("5a89"),c=(n("99af"),n("b0c0"),n("4c53"),n("96cf"),n("1da1")),u=(n("b8bf"),n("d3b7"),n("ddb0"),function(e,t){void 0===t&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),t===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=t,this.enabled=!0,this.target=new l["yb"],this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:l["J"].ROTATE,MIDDLE:l["J"].DOLLY,RIGHT:l["J"].PAN},this.touches={ONE:l["qb"].ROTATE,TWO:l["qb"].DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return u.phi},this.getAzimuthalAngle=function(){return u.theta},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),s=a.NONE},this.update=function(){var t=new l["yb"],o=(new l["db"]).setFromUnitVectors(e.up,new l["yb"](0,1,0)),r=o.clone().inverse(),m=new l["yb"],g=new l["db"];return function(){var e=n.object.position;return t.copy(e).sub(n.target),t.applyQuaternion(o),u.setFromVector3(t),n.autoRotate&&s===a.NONE&&T(E()),n.enableDamping?(u.theta+=d.theta*n.dampingFactor,u.phi+=d.phi*n.dampingFactor):(u.theta+=d.theta,u.phi+=d.phi),u.theta=Math.max(n.minAzimuthAngle,Math.min(n.maxAzimuthAngle,u.theta)),u.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,u.phi)),u.makeSafe(),u.radius*=h,u.radius=Math.max(n.minDistance,Math.min(n.maxDistance,u.radius)),!0===n.enableDamping?n.target.addScaledVector(p,n.dampingFactor):n.target.add(p),t.setFromSpherical(u),t.applyQuaternion(r),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(d.theta*=1-n.dampingFactor,d.phi*=1-n.dampingFactor,p.multiplyScalar(1-n.dampingFactor)):(d.set(0,0,0),p.set(0,0,0)),h=1,!!(f||m.distanceToSquared(n.object.position)>c||8*(1-g.dot(n.object.quaternion))>c)&&(n.dispatchEvent(i),m.copy(n.object.position),g.copy(n.object.quaternion),f=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",se,!1),n.domElement.removeEventListener("mousedown",$,!1),n.domElement.removeEventListener("wheel",ne,!1),n.domElement.removeEventListener("touchstart",oe,!1),n.domElement.removeEventListener("touchend",ae,!1),n.domElement.removeEventListener("touchmove",re,!1),document.removeEventListener("mousemove",ee,!1),document.removeEventListener("mouseup",te,!1),n.domElement.removeEventListener("keydown",ie,!1)};var n=this,i={type:"change"},o={type:"start"},r={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},s=a.NONE,c=1e-6,u=new l["ob"],d=new l["ob"],h=1,p=new l["yb"],f=!1,m=new l["xb"],g=new l["xb"],v=new l["xb"],_=new l["xb"],b=new l["xb"],y=new l["xb"],w=new l["xb"],x=new l["xb"],S=new l["xb"];function E(){return 2*Math.PI/60/60*n.autoRotateSpeed}function L(){return Math.pow(.95,n.zoomSpeed)}function T(e){d.theta-=e}function A(e){d.phi-=e}var R=function(){var e=new l["yb"];return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),p.add(e)}}(),N=function(){var e=new l["yb"];return function(t,i){!0===n.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),p.add(e)}}(),O=function(){var e=new l["yb"];return function(t,i){var o=n.domElement;if(n.object.isPerspectiveCamera){var r=n.object.position;e.copy(r).sub(n.target);var a=e.length();a*=Math.tan(n.object.fov/2*Math.PI/180),R(2*t*a/o.clientHeight,n.object.matrix),N(2*i*a/o.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(R(t*(n.object.right-n.object.left)/n.object.zoom/o.clientWidth,n.object.matrix),N(i*(n.object.top-n.object.bottom)/n.object.zoom/o.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function M(e){n.object.isPerspectiveCamera?h/=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e)),n.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function C(e){n.object.isPerspectiveCamera?h*=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e)),n.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function D(e){m.set(e.clientX,e.clientY)}function k(e){w.set(e.clientX,e.clientY)}function P(e){_.set(e.clientX,e.clientY)}function I(e){g.set(e.clientX,e.clientY),v.subVectors(g,m).multiplyScalar(n.rotateSpeed);var t=n.domElement;T(2*Math.PI*v.x/t.clientHeight),A(2*Math.PI*v.y/t.clientHeight),m.copy(g),n.update()}function F(e){x.set(e.clientX,e.clientY),S.subVectors(x,w),S.y>0?M(L()):S.y<0&&C(L()),w.copy(x),n.update()}function H(e){b.set(e.clientX,e.clientY),y.subVectors(b,_).multiplyScalar(n.panSpeed),O(y.x,y.y),_.copy(b),n.update()}function B(){}function V(e){e.deltaY<0?C(L()):e.deltaY>0&&M(L()),n.update()}function j(e){var t=!1;switch(e.keyCode){case n.keys.UP:O(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:O(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:O(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:O(-n.keyPanSpeed,0),t=!0;break}t&&(e.preventDefault(),n.update())}function z(e){if(1==e.touches.length)m.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);m.set(t,n)}}function U(e){if(1==e.touches.length)_.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);_.set(t,n)}}function G(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);w.set(0,i)}function X(e){n.enableZoom&&G(e),n.enablePan&&U(e)}function K(e){n.enableZoom&&G(e),n.enableRotate&&z(e)}function Y(e){if(1==e.touches.length)g.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);g.set(t,i)}v.subVectors(g,m).multiplyScalar(n.rotateSpeed);var o=n.domElement;T(2*Math.PI*v.x/o.clientHeight),A(2*Math.PI*v.y/o.clientHeight),m.copy(g)}function q(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),i=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,i)}y.subVectors(b,_).multiplyScalar(n.panSpeed),O(y.x,y.y),_.copy(b)}function W(e){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+i*i);x.set(0,o),S.set(0,Math.pow(x.y/w.y,n.zoomSpeed)),M(S.y),w.copy(x)}function J(e){n.enableZoom&&W(e),n.enablePan&&q(e)}function Z(e){n.enableZoom&&W(e),n.enableRotate&&Y(e)}function Q(){}function $(e){if(!1!==n.enabled){switch(e.preventDefault(),n.domElement.focus?n.domElement.focus():window.focus(),e.button){case 0:switch(n.mouseButtons.LEFT){case l["J"].ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;P(e),s=a.PAN}else{if(!1===n.enableRotate)return;D(e),s=a.ROTATE}break;case l["J"].PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;D(e),s=a.ROTATE}else{if(!1===n.enablePan)return;P(e),s=a.PAN}break;default:s=a.NONE}break;case 1:switch(n.mouseButtons.MIDDLE){case l["J"].DOLLY:if(!1===n.enableZoom)return;k(e),s=a.DOLLY;break;default:s=a.NONE}break;case 2:switch(n.mouseButtons.RIGHT){case l["J"].ROTATE:if(!1===n.enableRotate)return;D(e),s=a.ROTATE;break;case l["J"].PAN:if(!1===n.enablePan)return;P(e),s=a.PAN;break;default:s=a.NONE}break}s!==a.NONE&&(document.addEventListener("mousemove",ee,!1),document.addEventListener("mouseup",te,!1),n.dispatchEvent(o))}}function ee(e){if(!1!==n.enabled)switch(e.preventDefault(),s){case a.ROTATE:if(!1===n.enableRotate)return;I(e);break;case a.DOLLY:if(!1===n.enableZoom)return;F(e);break;case a.PAN:if(!1===n.enablePan)return;H(e);break}}function te(e){!1!==n.enabled&&(B(e),document.removeEventListener("mousemove",ee,!1),document.removeEventListener("mouseup",te,!1),n.dispatchEvent(r),s=a.NONE)}function ne(e){!1===n.enabled||!1===n.enableZoom||s!==a.NONE&&s!==a.ROTATE||(e.preventDefault(),e.stopPropagation(),n.dispatchEvent(o),V(e),n.dispatchEvent(r))}function ie(e){!1!==n.enabled&&!1!==n.enableKeys&&!1!==n.enablePan&&j(e)}function oe(e){if(!1!==n.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(n.touches.ONE){case l["qb"].ROTATE:if(!1===n.enableRotate)return;z(e),s=a.TOUCH_ROTATE;break;case l["qb"].PAN:if(!1===n.enablePan)return;U(e),s=a.TOUCH_PAN;break;default:s=a.NONE}break;case 2:switch(n.touches.TWO){case l["qb"].DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;X(e),s=a.TOUCH_DOLLY_PAN;break;case l["qb"].DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;K(e),s=a.TOUCH_DOLLY_ROTATE;break;default:s=a.NONE}break;default:s=a.NONE}s!==a.NONE&&n.dispatchEvent(o)}}function re(e){if(!1!==n.enabled)switch(e.preventDefault(),e.stopPropagation(),s){case a.TOUCH_ROTATE:if(!1===n.enableRotate)return;Y(e),n.update();break;case a.TOUCH_PAN:if(!1===n.enablePan)return;q(e),n.update();break;case a.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;J(e),n.update();break;case a.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;Z(e),n.update();break;default:s=a.NONE}}function ae(e){!1!==n.enabled&&(Q(e),n.dispatchEvent(r),s=a.NONE)}function se(e){!1!==n.enabled&&e.preventDefault()}n.domElement.addEventListener("contextmenu",se,!1),n.domElement.addEventListener("mousedown",$,!1),n.domElement.addEventListener("wheel",ne,!1),n.domElement.addEventListener("touchstart",oe,!1),n.domElement.addEventListener("touchend",ae,!1),n.domElement.addEventListener("touchmove",re,!1),n.domElement.addEventListener("keydown",ie,!1),-1===n.domElement.tabIndex&&(n.domElement.tabIndex=0),this.update()});u.prototype=Object.create(l["o"].prototype),u.prototype.constructor=u;var d=function(e,t){u.call(this,e,t),this.mouseButtons.LEFT=l["J"].PAN,this.mouseButtons.RIGHT=l["J"].ROTATE,this.touches.ONE=l["qb"].PAN,this.touches.TWO=l["qb"].DOLLY_ROTATE};d.prototype=Object.create(l["o"].prototype),d.prototype.constructor=d;n("4de4"),n("ac1f"),n("1276"),n("ace4"),n("5cc6"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7");var h=window.Zlib;function p(e){var t=new Uint8Array(e);return 31===t[0]&&139===t[1]}function f(e){var t=new Uint8Array(e);if(h){var n=new h.Gunzip(t),i=n.decompress();return i.buffer}console.error("Lack of necessary dependencies: gunzip.min.js.\n You can add this vendors to enable this feature or get it at https://github.com/imaya/zlib.js/blob/master/bin/gunzip.min.js")}var m=function(){function e(t,n,i){Object(a["a"])(this,e),this._options=i||{},this._size=n,this._data=t}return Object(s["a"])(e,[{key:"deinterleaveImage4",value:function(e,t,n){for(var i=e*e,o=2*e*e,r=3*e*e,a=0,s=0;s<i;s++)n[a++]=t[s],n[a++]=t[s+i],n[a++]=t[s+o],n[a++]=t[s+r]}},{key:"loadPacked",value:function(){var e=this,t=function(t){var n=t;p(n)&&(n=f(n));for(var i=Math.log(e._size)/Math.LN2,o=0,r={},a=0;a<=i;a++){var s=Math.pow(2,i-a),l=void 0;if(o>=n.byteLength)break;for(var c=0;c<6;c++){r[c]||(r[c]=[]);var u=void 0,d=void 0;l=s*s*4,u=new Uint8Array(n,o,l),d=new Uint8Array(l),e.deinterleaveImage4(s,u,d),u=d,r[c].push(u),o+=l}}e._packedImages=r,e.createRGBA8Packed()};return t(this._data)}},{key:"createRGBA8Packed",value:function(){for(var e=this.cubeTextures=[],t=this._size,n=this._packedImages,i=n[0].length,o=l["I"],r=0;r<i;r++){var a=new l["j"];e.push(a),a.format=l["fb"],a.encoding=o,a.minFilter=l["C"],a.magFilter=l["B"],a.generateMipmaps=!1;for(var s=0;s<6;s++){var c=new l["k"](n[s][r],t,t,l["fb"]);c.format=a.format,c.encoding=o,c.type=a.type,c.generateMipmaps=!1,a.images[s]=c,a.needsUpdate=!0}a.needsUpdate=!0,t/=2}this.cubeTexture=new l["j"],this.cubeTexture.format=l["fb"],this.cubeTexture.encoding=o,this.cubeTexture.minFilter=this._options.minFilter||l["C"],this.cubeTexture.magFilter=this._options.magFilter||l["B"],this.cubeTexture.generateMipmaps=!1;for(var u=0;u<6;u++){this.cubeTexture.image[u]=this.cubeTextures[0].images[u];for(var d=1;d<i;d++)this.cubeTexture.mipmaps[d-1]=this.cubeTextures[d],this.cubeTextures[d].needsUpdate=!0}this.cubeTexture.needsUpdate=!0}}]),e}(),g=function(){function e(t,n){Object(a["a"])(this,e),this._data=t,this._size=n}return Object(s["a"])(e,[{key:"loadPacked",value:function(){var e=this,t=function(t){var n=e._size,i=t;p(i)&&(i=f(i));var o=n*n*4,r=new Uint8Array(i,0,o),a=new l["k"](r,n,n,l["fb"]);return a};return t(this._data)}}]),e}(),v=(n("d81d"),n("fb6a"),n("cfc3"),function(){function e(t){Object(a["a"])(this,e),this._file=t,this.initSHCoef(t)}return Object(s["a"])(e,[{key:"initSHCoef",value:function(e){var t=this;this._sphCoef=e.slice(0,27);var n=1/(2*Math.sqrt(Math.PI)),i=-.5*Math.sqrt(3/Math.PI),o=-i,r=i,a=.5*Math.sqrt(15/Math.PI),s=-a,l=.25*Math.sqrt(5/Math.PI),c=s,u=.25*Math.sqrt(15/Math.PI),d=[n,n,n,i,i,i,o,o,o,r,r,r,a,a,a,s,s,s,l,l,l,c,c,c,u,u,u];this._sphCoef=d.map((function(e,n){return e*t._sphCoef[n]})),this._uniformSpherical=new Float32Array(27);for(var h=0;h<9;h++)this._uniformSpherical[3*h]=this._sphCoef[3*h],this._uniformSpherical[3*h+1]=this._sphCoef[3*h+1],this._uniformSpherical[3*h+2]=this._sphCoef[3*h+2]}}]),e}());n("baa5"),n("c19f"),n("4ec9"),n("3ca3"),n("466d"),n("2b3d");function _(e,t){return new Promise((function(n,i){var o=new XMLHttpRequest;o.open("GET",e,!0);var r=t&&t.responseType?t.responseType.toLowerCase():void 0;r&&(o.responseType=r),t&&t.progress&&o.addEventListener("progress",t.progress,!1),o.addEventListener("error",i,!1),o.addEventListener("load",(function(){"arraybuffer"===o.responseType||"blob"===o.responseType?n(o.response):n(o.responseText)})),o.send(null)}))}function b(e,t){return new Promise((function(n){var i=t&&t.responseType?t.responseType.toLowerCase():void 0,o=new window.FileReader;o.onload=function(e){n(e.target.result)},i?"arraybuffer"===i?o.readAsArrayBuffer(e):"blob"===i?n(e):"string"===i?o.readAsText(e):o.readAsDataURL(e):o.readAsText(e)}))}function y(e,t){return"string"===typeof e?_(e,t):b(e,t)}var w=y,x=window.zip,S=new Map,E=function(e){return"string"===typeof e||e instanceof String},L=function(e){return"blob:http"===e.substr(0,9)},T=function(e){return"http://"===e.substr(0,7)||"https://"===e.substr(0,8)},A=function(e){return!!E(e)&&(L(e)||T(e))},R=function(e){return new Promise((function(t,n){var i=new Image;i.onerror=function(){n(i)},i.onload=function(){t(i)},i.src=e}))},N=function(e){var t=window.URL.createObjectURL(e),n=R(t);return n["finally"]((function(){window.URL.revokeObjectURL(t)})),n},O=function(e){return new Promise((function(t,n){var i=new FileReader;i.onerror=function(){n(i)},i.onload=function(){t(this.result)},i.readAsArrayBuffer(e)}))},M=function(e){return w(e,{responseType:"arraybuffer"})},C=function(e){return w(e).then((function(e){return JSON.parse(e)}))},D=function(e){var t=JSON.parse(e);return Promise.resolve(t)},k={createJSONFromURL:C,createArrayBufferFromURL:M,createArrayBufferFromBlob:O,createImageFromBlob:N,createImageFromURL:R,requestURI:w,requestResource:function(e,t){var n=k.getExtension(e),i=k.getMimeType(n),o=t&&t.responseType?t.responseType.toLowerCase():void 0;if(o)return w(e,t);if(i){if(i.match("image"))return R(e);if(i.match("binary"))return M(e);if(i.match("json"))return C(e);if(i.match("text"))return w(e)}return w(e)},resolveData:function(e,t){var n,i,o=k.getExtension(e),r=k.getMimeType(o);return r&&(r.match("image")?E(t)?n=R:t instanceof Blob&&(n=N):r.match("json")?n=A(t)?C:D:r.match("binary")&&(E(t)?n=M:t instanceof Blob&&(n=O))),i=n?n(t):Promise.resolve(t),i},resolveFilesMap:function(e){var t=[];for(var n in e){var i=e[n],o=k.resolveData(n,i).then(function(e,t){this[e]=t}.bind(e,n));t.push(o)}return Promise.all(t).then((function(){return e}))},_unzipEntry:function(e){return new Promise((function(t){var n=e.filename,i=k.getExtension(n),o=k.getMimeType(i),r=x.BlobWriter;null===o.match("text")&&null===o.match("json")||(r=x.TextWriter),e.getData(new r(o),(function(e){t({filename:n,data:e})}))}))},unzipBlob:function(e){return new Promise((function(t,n){var i={},o=[];x.createReader(new x.BlobReader(e),(function(e){e.getEntries((function(n){for(var r=0;r<n.length;r++)if(!n[r].directory){var a=k._unzipEntry(n[r]);a.then((function(e){i[e.filename]=e.data})),o.push(a)}Promise.all(o).then((function(){e.close(),k.resolveFilesMap(i).then((function(e){t(e)}))}))}))}),(function(){n(this)}))}))},unzip:function(e){if(!x)return Promise.reject("missing deps to unzip, require https://github.com/gildas-lormeau/zip.js");if(E(e))return k.requestResource(e).then((function(e){var t=new Blob([e],{type:S.get("zip")});return k.unzipBlob(t)}));if(e instanceof Blob)return k.unzipBlob(e);if(e instanceof ArrayBuffer){var t=new Blob([e],{type:S.get("zip")});return k.unzipBlob(t)}return Promise.reject("cant unzip input")},getMimeType:function(e){return S.get(e)},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1)},addMimeTypeForExtension:function(e,t){void 0!==S.has(e)&&console.warn("the '"+e+"' already has a mimetype: "+S.get(e)),S.set(e,t)}};S.set("bin","application/octet-binary"),S.set("b3dm","application/octet-binary"),S.set("glb","application/octet-binary"),S.set("zip","application/octet-binary"),S.set("gz","application/octet-binary"),S.set("png","image/png"),S.set("jpg","image/jpeg"),S.set("jpeg","image/jpeg"),S.set("gif","image/gif"),S.set("json","application/json"),S.set("gltf","application/json"),S.set("osgjs","application/json"),S.set("txt","text/plain"),S.set("glsl","text/plain");var P=k,I=function(){function e(){Object(a["a"])(this,e),this._config=void 0,this._files={}}return Object(s["a"])(e,[{key:"loadPackage",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,P.unzip(t);case 2:return n=e.sent,e.abrupt("return",this.readZipContent(n,t));case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"readZipContent",value:function(e,t){var n=t.split("/").pop().split(".zip")[0];for(var i in this.name=n,e){var o=e[i],r=i.split("/").pop();this._files[r]=o}return this.init(this._files["config.json"])}},{key:"getImage",value:function(e,t,n){var i=this.getTextures(e,t,n);if(i.length)return i[0].limitSize&&(i[0].images[0].limitSize=i[0].limitSize),i[0].images[0]}},{key:"getTextures",value:function(e,t,n){var i=this._config.textures,o=i.filter((function(i){return i.encoding===t&&i.format===n&&i.type===e}));return o}},{key:"init",value:function(e){this._config=e;var t=this.getImage("specular_ue4","luv","cubemap"),n=t.file,i=t.width,o=this._files[n];this.cubeMapEnv=new m(o,i,e),this.cubeMapEnv.loadPacked();var r=t.limitSize,a=Math.log(i)/Math.LN2,s=a-Math.log(r)/Math.LN2;this.uEnvironmentLodRange=[a,s],this.uEnvironmentSize=[i,i];var c=this.getImage("brdf_ue4","rg16","lut"),u=c.file,d=c.width,h=this._files[u];this._integrateBRDF=new g(h,d),this.uIntegrateBRDF=this._integrateBRDF.loadPacked();var p=this.getImage("background","luv","cubemap"),f=p.file,_=p.width,b=this._files[f];if(this.backgroundEnv=new m(b,_,{minFilter:l["B"],magFilter:l["B"]}),this.backgroundEnv.loadPacked(),this.uBGEnvironmentSize=[_,_],this._spherical=new v(e.diffuseSPH),this.uEnvironmentSphericalHarmonics=this._spherical._uniformSpherical,e.Lights){var y=e.Lights[0];this.sunlightInfo={color:(new l["i"]).fromArray(y.color),position:(new l["yb"]).fromArray(y.direction).negate(),intensity:y.luminosity}}return this}}]),e}(),F=(n("4160"),n("159b"),n("99de")),H=n("7e84"),B=n("262e"),V="#define GLSLIFY 1\nuniform mat3 uModelNormalMatrix;\nvarying vec3 vViewPosition;\n\nvarying vec3 vNormal;\n\n#ifdef USE_TANGENT\n\tvarying vec3 vTangent;\n\tvarying vec3 vBitangent;\n#endif\n\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main(){\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n    #include <color_vertex>\n    #include <beginnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t// Todo: morph and skin\n\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n\n    #include <begin_vertex>\n\t#include <project_vertex>\n\n    vViewPosition = mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <shadowmap_vertex>\n}\n",j='#define GLSLIFY 1\n// refer: \n// https://github.com/cedricpinson/osgjs\n// https://google.github.io/filament/Filament.html\n\nuniform mat4 uEnvironmentTransform;\nmat3 environmentTransform;\nuniform float uEnvBrightness;\nuniform vec3 uEnvironmentSphericalHarmonics[9];\nuniform vec2 uEnvironmentSize;\nuniform vec2 uEnvironmentLodRange;\nuniform int uSpecularPeak;\nuniform int uOcclusionHorizon;\nuniform sampler2D uIntegrateBRDF;\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\nvarying vec3 vViewPosition;\n\nuniform samplerCube envMap;\n\nuniform vec2 uShadowDepthRange;\n\nvarying vec3 vNormal;\n#ifdef USE_TANGENT\n    varying vec3 vTangent;\n    varying vec3 vBitangent;\n#endif\n\n#include <common>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <color_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <packing>\n#include <logdepthbuf_pars_fragment>\n// ************************************ Shadow ************************************\nuniform bool receiveShadow;\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare, float shadowDistance) {\n        vec2 centroidCoord = uv / size;\n        centroidCoord = centroidCoord + 0.5;\n        vec2 f = fract(centroidCoord);\n\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = ( floor( uv * size - 0.5 ) + 0.5 ) * texelSize;\n\n        vec4 fetches;\n        const vec2 offset = vec2( 0.0, 1.0 );\n        fetches.x = compare - unpackRGBAToDepth( texture2D( depths, centroidUV + texelSize * offset.xx ));\n        fetches.y = compare - unpackRGBAToDepth( texture2D( depths, centroidUV + texelSize * offset.xy ));\n        fetches.z = compare - unpackRGBAToDepth( texture2D( depths, centroidUV + texelSize * offset.yx ));\n        fetches.w = compare - unpackRGBAToDepth( texture2D( depths, centroidUV + texelSize * offset.yy ));\n\n        // Shadow distance\n        float _a = mix(fetches.x, fetches.y, f.y);\n        float _b = mix(fetches.z, fetches.w, f.y);\n        shadowDistance = mix(_a, _b, f.x);\n\n\t\tvec4 st = step(fetches, vec4(0.0));\n\n        float a = mix(st.x, st.y, f.y);\n        float b = mix(st.z, st.w, f.y);\n        return mix(a, b, f.x);\n\t}\n\n\tfloat getShadow(bool lighted, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, out float shadowDistance ) {\n        bool earlyOut = false;\n        float shadow = 1.0;\n\n        if (!lighted){\n            shadow = 0.0;\n            earlyOut = true;\n        }\n\n        if(uShadowDepthRange.x == uShadowDepthRange.y){\n            earlyOut = true;\n        }\n\n        if (!earlyOut) {\n            shadowCoord.xyz /= shadowCoord.w;\n            shadowCoord.z += shadowBias;\n            // if ( something && something ) breaks ATI OpenGL shader compiler\n            // if ( all( something, something ) ) using this instead\n            bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n            bool inFrustum = all( inFrustumVec );\n            bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n            bool frustumTest = all( frustumTestVec );\n            if ( frustumTest ) {\n                vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n                // TODO: Shadow jitter\n                float res = texture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z, shadowDistance);\n                shadow = res;\n            }\n        }\n\t\treturn shadow;\n\t}\n#endif\n\n// DirectionalLight\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n#endif\n\n// Attenuation\n#if NUM_POINT_LIGHTS > 0 || NUM_SPOT_LIGHTS > 0\n    // Calculation of the attenuation\n    float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n    #if defined ( PHYSICALLY_CORRECT_LIGHTS )\n        // based upon Frostbite 3 Moving to Physically-based Rendering\n        // page 32, equation 26: E[window1]\n        // https://seblagarde.files.wordpress.com/2015/07/course_notes_moving_frostbite_to_pbr_v32.pdf\n        // this is intended to be used on spot and point lights who are represented as luminous intensity\n        // but who must be converted to luminous irradiance for surface lighting calculation\n        float distanceFalloff = 1.0 / max( pow( abs(lightDistance), decayExponent ), 0.01 );\n        if( cutoffDistance > 0.0 ) {\n            distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n        }\n        return distanceFalloff;\n    #else\n        if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n            return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n        }\n        return 1.0;\n    #endif\n    }\n#endif\n\n// PointLight\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\n\tfloat getPointDirectLightIrradiance( const in PointLight pointLight, vec3 vViewPosition) {\n\t\tvec3 lVector = pointLight.position - vViewPosition;\n\t\tfloat lightDistance = length( lVector );\n\t\treturn punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t}\n#endif\n\n// SpotLight\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\n\tfloat getSpotDirectLightIrradiance( const in SpotLight spotLight, vec3 vViewPosition) {\n\t\tvec3 lVector = spotLight.position - vViewPosition;\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( normalize( lVector ), spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n            return spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t} else {\n\t\t\treturn 0.0;\n\t\t}\n\t}\n#endif\n\n// ************************************ Light ************************************\n#if NUM_DIR_LIGHTS > 0\nvoid precomputeDirect(const in vec3 normal, const in vec3 viewDir, DirectionalLight directionalLight, out float attenuation, out vec3 lightDir, out float NoL) {\n    attenuation = 1.0;\n    lightDir = directionalLight.direction;\n    NoL = dot(normal, lightDir);\n}\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\nvoid precomputeSpot(const in vec3 normal, const in vec3 viewDir, const in vec3 viewVertex, SpotLight spotLight, out float attenuation, out vec3 lightDir, out float NoL) {\n    vec3 lightViewPosition = spotLight.position;\n    lightDir = lightViewPosition - viewVertex;\n    float dist = length(lightDir);\n    lightDir = dist > 0.0 ? lightDir / dist : vec3( 0.0, 1.0, 0.0 );\n    NoL = dot(lightDir, normal);\n    attenuation = getSpotDirectLightIrradiance(spotLight, vViewPosition);\n}\n#endif\n\n#if NUM_POINT_LIGHTS > 0\nvoid precomputePoint(const in vec3 normal, const in vec3 viewDir, const in vec3 viewVertex, PointLight pointLight, out float attenuation, out vec3 lightDir, out float NoL) {\n    lightDir = pointLight.position - viewVertex;\n    float dist = length(lightDir);\n    attenuation = getPointDirectLightIrradiance(pointLight, vViewPosition);\n    lightDir = dist > 0.0 ? lightDir / dist : vec3( 0.0, 1.0, 0.0 );\n    NoL = dot(lightDir, normal);\n}\n#endif\n\nvec3 precomputeLight_0(vec3 normal, vec3 eyeVector, float perceptualRoughness){\n    // perceptually linear roughness to roughness\n    float roughness = perceptualRoughness * perceptualRoughness;\n    float NoV =  clamp(dot(normal, eyeVector), 0., 1.);\n    return vec3(roughness, roughness * roughness, NoV);\n}\n\n// Isotropy\nfloat pow5(float x){\n\tfloat xx = x*x;\n\treturn xx * xx * x;\n}\n\n// ************************************ Specular ************************************\n// ************************ Normal Distribution Functions(NDF) **************************\n\n// [Blinn 1977, "Models of light reflection for computer synthesized pictures"]\nfloat D_Blinn_1062606552(vec3 precomputeLight, float NoH){\n    float a2 = precomputeLight.y;\n    float n = 2.0 / a2 - 2.0;\n    return (n+2.0) / (2.0* PI) * pow(NoH, n);   // 1 mad, 1 exp, 1 mul, 1 log\n}\n\n// [Beckmann 1963, "The scattering of electromagnetic waves from rough surfaces"]\nfloat D_Beckmann_1062606552(vec3 precomputeLight, float NoH){\n    float a2 = precomputeLight.y;\n    float NoH2 = NoH * NoH;\n    return exp( (NoH2 - 1.0) / (a2 * NoH2) ) / ( PI * a2 * NoH2 * NoH2 );\n}\n\n// GGX / Trowbridge-Reitz\n// [Walter et al. 2007, "Microfacet models for refraction through rough surfaces"]\nfloat D_GGX_1062606552(vec3 precomputeLight, float NoH){\n    float a2 = precomputeLight.y;\n    float d = (NoH * a2 - NoH) * NoH + 1.0;\t// 2 mad\n    return a2 / (PI * d * d);\t// 4 mul, 1 rcp\n}\n\nfloat Specular_D_1062606552(vec3 precomputeLight, float NoH){\n#if defined(NDF_BLINNPHONG)\n    return D_Blinn_1062606552(precomputeLight, NoH);\n#elif defined(NDF_BECKMANN)\n    return D_Beckmann_1062606552(precomputeLight, NoH);\n#elif defined(NDF_GGX)\n    return D_GGX_1062606552(precomputeLight, NoH);\n#else\nreturn D_GGX_1062606552(precomputeLight, NoH);\n    return 1.0;\n#endif\n}\n\n// ************************************ Fresnel ************************************\n\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\nvec3 F_Schlick_1062606552(float VoH, vec3 f0, float f90){\n    return f0 + (vec3(f90) - f0) * pow5(1.0 - VoH);\n}\n\n// [Cook-Torrance 1982]\nvec3 F_CookTorrance_1062606552(float VoH, vec3 f0, float f90){\n    vec3 sqrtSpec = sqrt(f0);\n    vec3 n = (1.0 + sqrtSpec) / (1.0 - sqrtSpec);\n    float c = clamp( VoH, 0.0, 1.0 );\n    vec3 g = sqrt(n * n + c * c - 1.0);\n\n    vec3 part1 = (g - c)/(g + c);\n    vec3 part2 = ((g + c) * c - 1.0)/((g - c) * c + 1.0);\n\n    return max(vec3(0.0), 0.5 * part1 * part1 * ( 1.0 + part2 * part2));\n}\n\nvec3 F_None_1062606552(vec3 f0){\n    return f0;\n}\n\nvec3 Specular_F_1062606552(float VoH, vec3 f0, float f90){\n#if defined(F_SCHLICK)\n    return F_Schlick_1062606552(VoH, f0, f90);\n#elif defined(F_COOKTORRANCE)\n    return F_CookTorrance_1062606552(VoH, f0, f90);\n#else // FRESNSEL_NONE\n    return F_None_1062606552(f0);\n#endif\n}\n\n// ******************************** Geometry Shadowing *********************************\nfloat Vis_Implicit_1062606552(){\n\treturn 0.25;\n}\n\n// [Neumann et al. 1999, "Compact metallic reflectance models"]\nfloat Vis_Neumann_1062606552(vec3 precomputeLight, float NoL){\n\tfloat NoV = precomputeLight.z;\n\treturn 1. / (4. * max(NoL, NoV));\n}\n\n// [Kelemen 2001, "A microfacet based coupled specular-matte brdf model with importance sampling"]\nfloat Vis_Kelemen_1062606552(float VoH){\n\t// constant to prevent NaN\n\treturn 1./(4. * VoH * VoH + 1e-5);\n}\n\n// Tuned to match behavior of Vis_Smith\n// [Schlick 1994, "An Inexpensive BRDF Model for Physically-Based Rendering"]\nfloat Vis_Schlick_1062606552(vec3 precomputeLight, float NoL){\n\tfloat a2 = precomputeLight.y;\n\tfloat NoV = precomputeLight.z;\n\tfloat k = sqrt(a2) * 0.5;\n\tfloat Vis_SchlickV = NoV * (1. - k) + k;\n\tfloat Vis_SchlickL = NoL * (1. - k) + k;\n\treturn 0.25 / (Vis_SchlickV * Vis_SchlickL);\n}\n\n// // Smith term for GGX\n// // [Smith 1967, "Geometrical shadowing of a random rough surface"]\nfloat Vis_Smith_1062606552(vec3 precomputeLight, float NoL){\n\tfloat a2 = precomputeLight.y;\n\tfloat NoV = precomputeLight.z;\n\tfloat Vis_SmithV = NoV + sqrt(NoV * (NoV - NoV * a2) + a2);\n\tfloat Vis_SmithL = NoL + sqrt(NoL * (NoL - NoL * a2) + a2);\n\treturn 1./(Vis_SmithV * Vis_SmithL);\n}\n\n// Appoximation of joint Smith term for GGX\n// [Heitz 2014, "Understanding the Masking-Shadowing Function in Microfacet-Based BRDFs"]\nfloat Vis_SmithJointApprox_1062606552(vec3 precomputeLight, float NoL){\n    float roughness = precomputeLight.x;\n    float NoV = precomputeLight.z;\n    float Vis_SmithV = NoL * (NoV * (1.0 - roughness) + roughness);\n    float Vis_SmithL = NoV * (NoL * (1.0 - roughness) + roughness);\n    return 0.5 / (Vis_SmithV + Vis_SmithL);\n}\n\nfloat Specular_V_1062606552(vec3 precomputeLight, float NoL, float VoH){\n#if defined(V_IMPLICIT)\n    return Vis_Implicit_1062606552();\n#elif defined(V_NEUMANN)\n    return Vis_Neumann_1062606552(precomputeLight, NoL);\n#elif defined(V_KELEMEN)\n    return Vis_Kelemen_1062606552(VoH);\n#elif defined(V_SCHLICK)\n    return Vis_Schlick_1062606552(precomputeLight, NoL);\n#elif defined(V_SMITH)\n    return Vis_Smith_1062606552(precomputeLight, NoL);\n#elif defined(V_SMITHJOINTAPPROX)\n    return Vis_SmithJointApprox_1062606552(precomputeLight, NoL);\n#else\n\treturn 0.25;\n#endif\n}\n\nvec3 specularCompute(vec3 precomputeLight, vec3 specular, float NoL, float NoH, float VoH, float f90) {\n    float D = Specular_D_1062606552(precomputeLight, NoH);\n    vec3 F = Specular_F_1062606552(VoH, specular, f90);\n    float V = Specular_V_1062606552(precomputeLight, NoL, VoH);\n\t\n    return (D * V) * F;\n}\n\n// ************************************ Diffuse ************************************\nvec3 Diffuse_Lambert_1062606552(vec3 diffuse){\n\treturn diffuse / PI;\n}\n\n// [Burley 2012, "Physically-Based Shading at Disney"]\nvec3 Diffuse_Burley_1062606552(vec3 precomputeLight, vec3 diffuse, float NoL, float VoH){\n    float Roughness = precomputeLight.x;\n    float NoV =  precomputeLight.z;\n\n\tfloat FD90 = 0.5 + 2. * VoH * VoH * Roughness;\n\tfloat FdV = 1. + (FD90 - 1.) * pow5(1. - NoV);\n\tfloat FdL = 1. + (FD90 - 1.) * pow5(1. - NoL);\n\treturn diffuse * ((1. / PI) * FdV * FdL);\n}\n\n// [Gotanda 2012, "Beyond a Simple Physically Based Blinn-Phong Model in Real-Time"]\nvec3 Diffuse_OrenNayar_1062606552(vec3 precomputeLight, vec3 diffuse, float NoL, float VoH){\n    float Roughness = precomputeLight.x;\n\tfloat a = precomputeLight.y;\n    float NoV = precomputeLight.z;\n\tfloat s = a; // / ( 1.29 + 0.5 * a );\n\tfloat s2 = s * s;\n\tfloat VoL = 2. * VoH * VoH - 1.;  // double angle identity\n\tfloat Cosri = VoL - NoV * NoL;\n\tfloat C1 = 1. - 0.5 * s2 / (s2 + 0.33);\n\tfloat C2 = 0.45 * s2 / (s2 + 0.09) * Cosri * (Cosri >= 0. ? 1./(max(NoL, NoV)) : 1.);\n\treturn diffuse / PI * (C1 + C2) * (1. + Roughness * 0.5);\n}\n\n// [Gotanda 2014, "Designing Reflectance Models for New Consoles"]\nvec3 Diffuse_Gotanda_1062606552(vec3 precomputeLight, vec3 diffuse, float NoL, float VoH){\n    float Roughness = precomputeLight.x;\n\tfloat a = precomputeLight.y;\n    float NoV = precomputeLight.z;\n\tfloat a2 = a * a;\n\tfloat F0 = 0.04;\n\tfloat VoL = 2. * VoH * VoH - 1.;    // double angle identity\n\tfloat Cosri = VoL - NoV * NoL;\n\n\tfloat a2_13 = a2 + 1.36053;\n\tfloat Fr = ( 1. - ( 0.542026*a2 + 0.303573*a ) / a2_13 ) * ( 1. - pow( 1. - NoV, 5. - 4.*a2 ) / a2_13 ) * ( ( -0.733996*a2*a + 1.50912*a2 - 1.16402*a ) * pow( 1. - NoV, 1. + 1./(39.*a2*a2+1.) ) + 1. );\n\tfloat Lm = ( max( 1. - 2.*a, 0. ) * ( 1. - pow5( 1. - NoL ) ) + min( 2.*a, 1. ) ) * ( 1. - 0.5*a * (NoL - 1.) ) * NoL;\n\tfloat Vd = ( a2 / ( (a2 + 0.09) * (1.31072 + 0.995584 * NoV) ) ) * ( 1. - pow( 1. - NoL, ( 1. - 0.3726732 * NoV * NoV ) / ( 0.188566 + 0.38841 * NoV ) ) );\n\tfloat Bp = Cosri < 0. ? 1.4 * NoV * NoL * Cosri : Cosri;\n\tfloat Lr = (21.0 / 20.0) * (1. - F0) * ( Fr * Lm + Vd + Bp );\n\treturn diffuse / PI * Lr;\n}\n\nvec3 diffuseCompute(vec3 precomputeLight, vec3 diffuse, float NoL, float VoH){\n#if defined(DIFFUSE_LAMBERT)\n    return Diffuse_Lambert_1062606552(diffuse);\n#elif defined(DIFFUSE_BURLEY)\n    return Diffuse_Burley_1062606552(precomputeLight, diffuse, NoL, VoH);\n#elif defined(DIFFUSE_ORENNAYAR)\n    return Diffuse_OrenNayar_1062606552(precomputeLight, diffuse, NoL, VoH);\n#elif defined(DIFFUSE_GOTANDA)\n    return Diffuse_Gotanda_1062606552(precomputeLight, diffuse, NoL, VoH);\n#else // DIFFUSE_NONE\n    return vec3(0.0);\n#endif\n}\n\nvoid computeLight(in vec3 normal, in vec3 viewDir, in float NoL, in vec3 precomputeLight, in vec3 diffuse, in vec3 specular, in float attenuation, in vec3 lightColor, in vec3 lightDir, in float f90, out vec3 diffuseOut, out vec3 specularOut, out bool lighted) {\n    lighted = NoL > 0.0;\n    if (!lighted) {\n        specularOut = diffuseOut = vec3(0.0);\n        return;\n    }\n    vec3 H = normalize(viewDir + lightDir);\n    float NoH =  clamp(dot(normal, H), 0., 1.);\n    float VoH =  clamp(dot(viewDir, H), 0., 1.);\n\t\n    vec3 colorAttenuate = attenuation * NoL * lightColor;\n    diffuseOut = colorAttenuate * diffuseCompute(precomputeLight, diffuse, NoL, VoH);\n    specularOut = colorAttenuate * specularCompute(precomputeLight, specular, NoL, NoH, VoH, f90);\n}\n\n// ************************************ IBL ************************************\nmat3 getEnvironmentTransfrom(mat4 transform) {\n    vec3 x = vec3(transform[0][0], transform[1][0], transform[2][0]);\n    vec3 y = vec3(transform[0][1], transform[1][1], transform[2][1]);\n    vec3 z = vec3(transform[0][2], transform[1][2], transform[2][2]);\n    mat3 m = mat3(x,y,z);\n    return m;\n}\n\nvec3 computeDiffuseSPH(vec3 normal, vec3 sphericalHarmonics[9]){\n    float x = normal.x;\n    float y = normal.y;\n    float z = normal.z;\n    vec3 result = (\n        sphericalHarmonics[0] +\n        sphericalHarmonics[1] * y +\n        sphericalHarmonics[2] * z +\n        sphericalHarmonics[3] * x +\n        sphericalHarmonics[4] * y * x +\n        sphericalHarmonics[5] * y * z +\n        sphericalHarmonics[6] * (3.0 * z * z - 1.0) +\n        sphericalHarmonics[7] * (z * x) +\n        sphericalHarmonics[8] * (x*x - y*y)\n    );\n    return max(result, vec3(0.0));\n}\n\n#ifdef MOBILE\n    // https://www.unrealengine.com/blog/physically-based-shading-on-mobile\nvec3 integrateBRDF(vec3 specular, float roughness, float NoV, float f90) {\n    const vec4 c0 = vec4(-1.0, -0.0275, -0.572, 0.022);\n    const vec4 c1 = vec4(1.0, 0.0425, 1.04, -0.04);\n    vec4 r = roughness * c0 + c1;\n    float a004 = min(r.x * r.x, exp2(-9.28 * NoV)) * r.x + r.y;\n    vec2 AB = vec2(-1.04, 1.04) * a004 + r.zw;\n    return specular * AB.x + AB.y * f90;\n}\n\n#else\nvec3 integrateBRDF(const in vec3 specular, const in float roughness, const in float NoV, const in float f90) {\n    vec4 rgba = texture2D(uIntegrateBRDF, vec2(NoV, roughness));\n    float b = (rgba[3] * 65280.0 + rgba[2] * 255.0);\n    float a = (rgba[1] * 65280.0 + rgba[0] * 255.0);\n    const float div = 1.0 / 65535.0;\n    return (specular * a + b * f90) * div;\n}\n#endif\n\n// frostbite, lagarde paper p67\n// http://www.frostbite.com/wp-content/uploads/2014/11/course_notes_moving_frostbite_to_pbr.pdf\nfloat linRoughnessToMipmap(float roughnessLinear){\n    return sqrt(roughnessLinear);\n}\n\nvec3 prefilterEnvMapCube(const in float rLinear, const in vec3 R) {\n    vec3 dir = R;\n    float lod = linRoughnessToMipmap(rLinear) * uEnvironmentLodRange[1]; //( uEnvironmentMaxLod - 1.0 );\n    lod = min( uEnvironmentLodRange[0], lod );\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\n    float scale = 1.0 - exp2(lod) / uEnvironmentSize[0];\n    vec3 absDir = abs(dir);\n    float M = max(max(absDir.x, absDir.y), absDir.z);\n    // cubemapSeamlessFixDirection\n    if (absDir.x != M) dir.x *= scale;\n    if (absDir.y != M) dir.y *= scale;\n    if (absDir.z != M) dir.z *= scale;\n\n    return LogLuvToLinear(textureCubeLodEXT(envMap, dir, lod)).rgb;\n}\n\n// From Sebastien Lagarde Moving Frostbite to PBR page 69\n// We have a better approximation of the off specular peak\n// but due to the other approximations we found this one performs better.\n// N is the normal direction\n// R is the mirror vector\n// This approximation works fine for G smith correlated and uncorrelated\nvec3 getSpecularDominantDir(const in vec3 N, const in vec3 R, const in float realRoughness) {\n    float smoothness = 1.0 - realRoughness;\n    float lerpFactor = smoothness * (sqrt(smoothness) + realRoughness);\n    return mix(N, R, lerpFactor);\n}\n\nvec3 getPrefilteredEnvMapColor(const in vec3 normal, const in vec3 viewDir, const in float roughness, const in vec3 frontNormal) {\n    vec3 R = reflect(-viewDir, normal);\n    // From Sebastien Lagarde Moving Frostbite to PBR page 69\n    // so roughness = linRoughness * linRoughness\n    R = getSpecularDominantDir(normal, R, roughness);\n\n    vec3 prefilteredColor = prefilterEnvMapCube(roughness, environmentTransform * R);\n\n    float factor = clamp(1.0 + dot(R, frontNormal), 0.0, 1.0);\n    prefilteredColor *= factor * factor;\n    return prefilteredColor;\n}\n\nvec3 computeIBLSpecularUE4(const in vec3 normal, const in vec3 viewDir, const in float roughness, const in vec3 specular, const in vec3 frontNormal, const in float f90) {\n    float NoV = dot(normal, viewDir);\n    return getPrefilteredEnvMapColor(normal, viewDir, roughness, frontNormal) * integrateBRDF(specular, roughness, NoV, f90);\n}\n\nfloat occlusionHorizon(const in float ao, const in vec3 normal, const in vec3 viewDir) {\n    if (uOcclusionHorizon == 0) return 1.0;\n    // http://marmosetco.tumblr.com/post/81245981087\n    float d = dot(normal, viewDir) + ao;\n    return clamp((d * d) - 1.0 + ao, 0.0, 1.0);\n}\n\n// http://www.neilmendoza.com/glsl-rotation-about-an-arbitrary-axis/\nmat3 rotationMatrix3(vec3 axis, float angle) {\n\taxis = normalize(axis);\n\tfloat s = sin(angle);\n\tfloat c = cos(angle);\n\tfloat oc = 1.0 - c;\n\treturn mat3(oc * axis.x * axis.x + c,\n                oc * axis.x * axis.y - axis.z * s,\n                oc * axis.z * axis.x + axis.y * s,\n\t\t\t\toc * axis.x * axis.y + axis.z * s,\n                oc * axis.y * axis.y + c,\n                oc * axis.y * axis.z - axis.x * s,\n                oc * axis.z * axis.x - axis.y * s,\n                oc * axis.y * axis.z + axis.x * s,\n                oc * axis.z * axis.z + c);\n}\n\nvoid main(){\n    vec3 viewDir = -normalize(vViewPosition);\n    environmentTransform = getEnvironmentTransfrom(uEnvironmentTransform);\n\n    vec4 diffuseColor = vec4(diffuse, opacity);\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <color_fragment>\n    #include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n    #include <map_fragment>\n    #include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n    #include <emissivemap_fragment>\n    // Material diffuse/specular (TODO: SpecularMap Supportã€F0 Param)\n    float f0 = 0.04;\n    vec3 materialSpecular = mix(vec3(f0), diffuseColor.rgb, metalnessFactor);\n    float materialF90 = clamp(50.0 * materialSpecular.g, 0.0, 1.0);\n    vec3 materialDiffuse = diffuseColor.rgb * (1.0 - metalnessFactor);\n    // Roughness\n    const float minRoughness = 0.001;\n    float materialRoughness = max(minRoughness , roughnessFactor);\n\n    // IBL\n    vec3 transformedNormal = environmentTransform * normal;\n    vec3 diffuseIBL = materialDiffuse * computeDiffuseSPH(transformedNormal, uEnvironmentSphericalHarmonics);\n    vec3 specularIBL = computeIBLSpecularUE4(normal, viewDir, materialRoughness, materialSpecular, normal, materialF90);\n    // AO\n    float materialAO = 1.0;\n    #ifdef USE_AOMAP\n\tmaterialAO = (texture2D(aoMap, vUv2).r - 1.0) * aoMapIntensity + 1.0;\n    #endif\n    diffuseIBL *= uEnvBrightness * materialAO;\n\n    float aoSpec = 1.0;\n    aoSpec = occlusionHorizon(materialAO, normal, viewDir);\n    specularIBL *= uEnvBrightness * aoSpec;\n\n    // Light\n    float attenuation, NoL;\n    vec3 lightDir;\n    vec3 lightSpecular;\n    vec3 lightDiffuse;\n    vec3 resultLightSpecular;\n    vec3 resultLightDiffuse;\n    bool lighted;\n    float shadow = 1.0;\n    vec3 prepCompute = precomputeLight_0(normal, viewDir, max(0.045, materialRoughness));\n    float shadowDistance;\n\n    #if NUM_DIR_LIGHTS > 0\n        DirectionalLight directionalLight;\n        #pragma unroll_loop\n\t    for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n            directionalLight = directionalLights[ i ];\n            precomputeDirect(normal, viewDir, directionalLight, attenuation, lightDir, NoL);\n            computeLight(normal, viewDir, NoL, prepCompute, materialDiffuse, materialSpecular, attenuation, directionalLights[ i ].color, lightDir, materialF90, lightDiffuse, lightSpecular, lighted);\n            // Shadow\n            #if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n            shadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( lighted, directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ], shadowDistance ) : 1.0;\n            lightDiffuse *= shadow;\n            lightSpecular *= shadow;\n            #endif\n\n            resultLightDiffuse += lightDiffuse;\n            resultLightSpecular += lightSpecular;\n        }\n    #endif\n    #if NUM_SPOT_LIGHTS > 0\n        SpotLight spotLight;\n        #pragma unroll_loop\n\t    for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n            spotLight = spotLights[ i ];\n            precomputeSpot(normal, viewDir, vViewPosition, spotLight, attenuation, lightDir, NoL);\n            computeLight(normal, viewDir, NoL, prepCompute, materialDiffuse, materialSpecular, attenuation, spotLight.color, lightDir, materialF90, lightDiffuse, lightSpecular, lighted);\n            // TODO: Shadow && Anisotropy\n            resultLightDiffuse += lightDiffuse;\n            resultLightSpecular += lightSpecular;\n        }\n    #endif\n    #if NUM_POINT_LIGHTS > 0\n        PointLight pointLight;\n        #pragma unroll_loop\n\t    for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n            pointLight = pointLights[ i ];\n            // TODO: Shadow && Anisotropy\n            precomputePoint(normal, viewDir, vViewPosition, pointLight, attenuation, lightDir, NoL);\n            computeLight(normal, viewDir, NoL, prepCompute, materialDiffuse, materialSpecular, attenuation, pointLight.color, lightDir, materialF90, lightDiffuse, lightSpecular, lighted);\n            resultLightDiffuse += lightDiffuse;\n            resultLightSpecular += lightSpecular;\n        }\n    #endif\n\n    // Test\n    #ifndef ENABLE_IBL\n        diffuseIBL = vec3(0.);\n        specularIBL = vec3(0.);\n    #endif\n    #ifndef ENABLE_LIGHT\n        resultLightDiffuse = vec3(0.);\n        resultLightSpecular = vec3(0.);\n    #endif\n\n    vec3 resultDiffuse = diffuseIBL + resultLightDiffuse;\n    vec3 resultSpecular = specularIBL + resultLightSpecular;\n\n    vec3 totalResult = resultDiffuse + resultSpecular + totalEmissiveRadiance;\n    vec4 frag = vec4( totalResult, diffuseColor.a );\n    gl_FragColor = LinearTosRGB(frag);\n\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n}',z=["map","normalMap","lightMap","bumpMap","roughnessMap","metalnessMap","aoMap","emissiveMap","displacementmap","envMap"],U=["color","roughness","metalness","emissive"],G={uBrightness:{value:1},uEnvironmentTransform:{value:new l["N"]}},X={roughness:{value:1},metalness:{value:.5},color:{value:new l["i"](16777215)},emissive:{value:new l["i"](0)},uEnvironmentTransform:{value:new l["N"]},uBrightness:{value:1},uSpecularPeak:{value:1},uOcclusionHorizon:{value:0},uAnisotropyRotation:{value:0},uAnisotropyFactor:{value:0}},K={ENABLE_IBL:1,ENABLE_LIGHT:1,DIFFUSE_LAMBERT:1,NDF_GGX:1,F_SCHLICK:1,V_SMITHJOINTAPPROX:1},Y=function(e){function t(e,n){var i;Object(a["a"])(this,t);var o=e.material;i=Object(F["a"])(this,Object(H["a"])(t).call(this)),i.modelNormalMatrix=new l["M"],i.copy(o),i.defines=K,i.normalMapType=o.normalMapType,n.isMobile&&(i.defines.MOBILE=1);var r=l["vb"];return i.uniforms=l["wb"].merge([r.common,r.normalmap,r.lightmap,r.bumpmap,r.roughnessmap,r.metalnessmap,r.aomap,r.emissivemap,r.displacementmap,r.envmap,r.fog,r.lights,X]),i.uniforms["uShadowDepthRange"]={value:n.shadowDepthRange},i.uniforms["uEnvironmentSphericalHarmonics"]={value:n.uEnvironmentSphericalHarmonics},i.uniforms["uEnvironmentLodRange"]={value:n.uEnvironmentLodRange},i.uniforms["uEnvironmentSize"]={value:n.uEnvironmentSize},i.uniforms["uIntegrateBRDF"]={value:n.uIntegrateBRDF},i.uniforms["uModelNormalMatrix"]={value:i.modelNormalMatrix},i.syncParam(o),i.vertexShader=V,i.fragmentShader=j,i.lights=!0,e.onBeforeRender=function(){i.modelNormalMatrix.getNormalMatrix(e.matrixWorld)},i}return Object(B["a"])(t,e),Object(s["a"])(t,[{key:"syncParam",value:function(e){var t=this;z.forEach((function(n){void 0!=e[n]&&(t[n]=e[n],t.uniforms[n].value=e[n])})),U.forEach((function(n){void 0!=e[n]&&(t.uniforms[n].value=e[n])})),this.uniforms.diffuse.value=e.color||new Color(16777215)}}]),t}(l["jb"]),q="#define GLSLIFY 1\nvarying vec3 vViewNormal;\n\nvoid main() {\n    vViewNormal = normalMatrix * normal;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",W="#define GLSLIFY 1\nuniform samplerCube envMap;\nuniform mat4 uEnvironmentTransform;\nuniform float uEnvBrightness;\nuniform vec2 uEnvironmentSize;\n\nvarying vec3 vViewNormal;\n\nmat3 getEnvironmentTransfrom( mat4 transform ) {\n    vec3 x = vec3(transform[0][0], transform[1][0], transform[2][0]);\n    vec3 y = vec3(transform[0][1], transform[1][1], transform[2][1]);\n    vec3 z = vec3(transform[0][2], transform[1][2], transform[2][2]);\n    mat3 m = mat3(x,y,z);\n    return m;\n}\n\nvec3 cubemapSeamlessFixDirection(const in vec3 direction, const in float scale ){\n    vec3 dir = direction;\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\n    float M = max(max(abs(dir.x), abs(dir.y)), abs(dir.z));\n\n    if (abs(dir.x) != M) dir.x *= scale;\n    if (abs(dir.y) != M) dir.y *= scale;\n    if (abs(dir.z) != M) dir.z *= scale;\n\n    return dir;\n}\n\nvec4 textureCubemap(const in samplerCube tex, const in vec3 dir ){\n    vec4 rgba = textureCube( tex, dir );\n    return LogLuvToLinear(rgba);\n}\n\n// Seamless cubemap for background\nvec4 textureCubeFixed(const in samplerCube tex, const in vec3 direction ){\n    // http://seblagarde.wordpress.com/2012/06/10/amd-cubemapgen-for-physically-based-rendering/\n    float scale = 1.0 - 1.0 / uEnvironmentSize[0];\n    vec3 dir = cubemapSeamlessFixDirection( direction, scale);\n    return textureCubemap( tex, dir );\n}\n\nvoid main(){\n    vec3 direction = normalize(vViewNormal);\n    direction = getEnvironmentTransfrom( uEnvironmentTransform ) * direction;\n    vec4 samplerColor = uEnvBrightness * textureCubeFixed(envMap, direction);\n    gl_FragColor = LinearTosRGB(samplerColor);\n}\n",J=function(e){function t(e){Object(a["a"])(this,t);var n=e.envMap,i=e.uBGEnvironmentSize,o=e.uEnvBrightness,r=e.debug,s=G.uEnvironmentTransform,c={envMap:{value:n},uEnvironmentSize:{value:i},uEnvBrightness:o,uEnvironmentTransform:s};return Object(F["a"])(this,Object(H["a"])(t).call(this,{uniforms:c,vertexShader:q,fragmentShader:W,side:l["n"],depthTest:!!r}))}return Object(B["a"])(t,e),t}(l["jb"]),Z=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Object(a["a"])(this,t);var o=i/2,r=new l["nb"](o,20,20),s=new J(e);return n=Object(F["a"])(this,Object(H["a"])(t).call(this,r,s)),n.radius=o,n.sphere=r,n}return Object(B["a"])(t,e),Object(s["a"])(t,[{key:"setSize",value:function(e){var t=e/this.radius;this.scale.setScalar(t)}},{key:"envMap",get:function(){return this.material.envMap},set:function(e){this.material.envMap=e}},{key:"mesh",get:function(){return this.sphere}}]),t}(l["O"]),Q="./assets/envMap/",$=["Arches","GCanyon","Milkyway","PaperMill","Venice","TropicalRuins","Alexs","Pedestrian"],ee=["Lambert","Burley","OrenNayar","Gotanda","None"],te=["Schlick","CookTorrance","None"],ne=["GGX","BlinnPhong","Beckmann"],ie=["SmithJointApprox","Implicit","Neumann","Kelemen","Schlick","Smith"];function oe(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=(new l["c"]).setFromObject(t),r=o.getSize(new l["yb"]),a=Math.max(r.x,r.y,r.z),s=a/(2*Math.atan(Math.PI*e.fov/360)),c=s/e.aspect,u=i*Math.max(s,c);return e.near=u/100,e.far=100*u,e.position.set(0,u/4,u),e.updateProjectionMatrix(),n&&(n.maxDistance=20*u,n.update()),u}function re(e,t,n,i){var o=(new l["c"]).setFromObject(n);e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024;var r=e.shadow.camera;r.position.copy(e.position),r.lookAt(new l["yb"](0,0,0)),r.position.set(0,0,0),r.updateMatrixWorld(!0);var a=new l["N"];if(a.getInverse(r.matrixWorld),o.applyMatrix4(a),r.left=o.min.x-.01,r.right=o.max.x+.01,r.top=o.min.y-.01,r.bottom=o.max.y+.01,r.near=-o.max.z-.01,r.far=.01-o.min.z,r.updateProjectionMatrix(),e.shadow.bias=-.01,i){var s=new l["m"](e,5,16777215);t.add(s);var c=new l["g"](r);t.add(c)}}n("c975");function ae(e){var t;return t=e.currentStyle?e.currentStyle.width:getComputedStyle(e,!1).width,~t.indexOf("px")&&(t=t.slice(0,-2)),t}function se(e){var t;return t=e.currentStyle?e.currentStyle.height:getComputedStyle(e,!1).height,~t.indexOf("px")&&(t=t.slice(0,-2)),t}function le(){var e=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);return e||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent)}n("a4d3"),n("e01a"),n("d28b"),n("277d"),n("a15b"),n("a434"),n("0d03"),n("b680"),n("1d1c"),n("7a82"),n("e439"),n("3410"),n("b64b"),n("131a"),n("acd8"),n("e25e"),n("4d63"),n("25f0"),n("5319"),n("4795");var ce=n("53ca");function ue(e){if(e&&"undefined"!==typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}function de(e,t){var n=e.__state.conversionName.toString(),i=Math.round(e.r),o=Math.round(e.g),r=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){var u=e.hex.toString(16);while(u.length<6)u="0"+u;return"#"+u}return"CSS_RGB"===n?"rgb("+i+","+o+","+r+")":"CSS_RGBA"===n?"rgba("+i+","+o+","+r+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+i+","+o+","+r+"]":"RGBA_ARRAY"===n?"["+i+","+o+","+r+","+a+"]":"RGB_OBJ"===n?"{r:"+i+",g:"+o+",b:"+r+"}":"RGBA_OBJ"===n?"{r:"+i+",g:"+o+",b:"+r+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+",a:"+a+"}":"unknown format"}var he=Array.prototype.forEach,pe=Array.prototype.slice,fe={BREAK:{},extend:function(e){return this.each(pe.call(arguments,1),(function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))}),this),e},defaults:function(e){return this.each(pe.call(arguments,1),(function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))}),this),e},compose:function(){var e=pe.call(arguments);return function(){for(var t=pe.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(e)if(he&&e.forEach&&e.forEach===he)e.forEach(t,n);else if(e.length===e.length+0){var i=void 0,o=void 0;for(i=0,o=e.length;i<o;i++)if(i in e&&t.call(n,e[i],i)===this.BREAK)return}else for(var r in e)if(t.call(n,e[r],r)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var i=void 0;return function(){var o=this,r=arguments;function a(){i=null,n||e.apply(o,r)}var s=n||!i;clearTimeout(i),i=setTimeout(a,t),s&&e.apply(o,r)}},toArray:function(e){return e.toArray?e.toArray():pe.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}},me=[{litmus:fe.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:de},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:de},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:de},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:de}}},{litmus:fe.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:fe.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:fe.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(fe.isNumber(e.r)&&fe.isNumber(e.g)&&fe.isNumber(e.b)&&fe.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(fe.isNumber(e.r)&&fe.isNumber(e.g)&&fe.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(fe.isNumber(e.h)&&fe.isNumber(e.s)&&fe.isNumber(e.v)&&fe.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(fe.isNumber(e.h)&&fe.isNumber(e.s)&&fe.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],ge=void 0,ve=void 0,_e=function(){ve=!1;var e=arguments.length>1?fe.toArray(arguments):arguments[0];return fe.each(me,(function(t){if(t.litmus(e))return fe.each(t.conversions,(function(t,n){if(ge=t.read(e),!1===ve&&!1!==ge)return ve=ge,ge.conversionName=n,ge.conversion=t,fe.BREAK})),fe.BREAK})),ve},be=void 0,ye={hsv_to_rgb:function(e,t,n){var i=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),r=n*(1-t),a=n*(1-o*t),s=n*(1-(1-o)*t),l=[[n,s,r],[a,n,r],[r,n,s],[r,a,n],[s,r,n],[n,r,a]][i];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var i=Math.min(e,t,n),o=Math.max(e,t,n),r=o-i,a=void 0,s=void 0;return 0===o?{h:NaN,s:0,v:0}:(s=r/o,a=e===o?(t-n)/r:t===o?2+(n-e)/r:4+(e-t)/r,a/=6,a<0&&(a+=1),{h:360*a,s:s,v:o/255})},rgb_to_hex:function(e,t,n){var i=this.hex_with_component(0,2,e);return i=this.hex_with_component(i,1,t),i=this.hex_with_component(i,0,n),i},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(be=8*t)|e&~(255<<be)}},we="function"===typeof Symbol&&"symbol"===Object(ce["a"])(Symbol.iterator)?function(e){return Object(ce["a"])(e)}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":Object(ce["a"])(e)},xe=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Se=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Ee=function e(t,n,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,i)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(i):void 0},Le=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+Object(ce["a"])(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Te=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==Object(ce["a"])(t)&&"function"!==typeof t?e:t},Ae=function(){function e(){if(xe(this,e),this.__state=_e.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Se(e,[{key:"toString",value:function(){return de(this)}},{key:"toHexString",value:function(){return de(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function Re(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||Ae.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(Ae.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function Ne(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||Ae.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(Ae.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}Ae.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=ye.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");fe.extend(e.__state,ye.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},Ae.recalculateHSV=function(e){var t=ye.rgb_to_hsv(e.r,e.g,e.b);fe.extend(e.__state,{s:t.s,v:t.v}),fe.isNaN(t.h)?fe.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},Ae.COMPONENTS=["r","g","b","h","s","v","hex","a"],Re(Ae.prototype,"r",2),Re(Ae.prototype,"g",1),Re(Ae.prototype,"b",0),Ne(Ae.prototype,"h"),Ne(Ae.prototype,"s"),Ne(Ae.prototype,"v"),Object.defineProperty(Ae.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(Ae.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=ye.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Oe=function(){function e(t,n){xe(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return Se(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),Me={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},Ce={};fe.each(Me,(function(e,t){fe.each(e,(function(e){Ce[e]=t}))}));var De=/(\d+(\.\d+)?)px/;function ke(e){if("0"===e||fe.isUndefined(e))return 0;var t=e.match(De);return fe.isNull(t)?0:parseFloat(t[1])}var Pe={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var i=n,o=t;fe.isUndefined(o)&&(o=!0),fe.isUndefined(i)&&(i=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,i){var o=n||{},r=Ce[t];if(!r)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(r);switch(r){case"MouseEvents":var s=o.x||o.clientX||0,l=o.y||o.clientY||0;a.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,s,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;fe.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break;default:a.initEvent(t,o.bubbles||!1,o.cancelable||!0);break}fe.defaults(a,i),e.dispatchEvent(a)},bind:function(e,t,n,i){var o=i||!1;return e.addEventListener?e.addEventListener(t,n,o):e.attachEvent&&e.attachEvent("on"+t,n),Pe},unbind:function(e,t,n,i){var o=i||!1;return e.removeEventListener?e.removeEventListener(t,n,o):e.detachEvent&&e.detachEvent("on"+t,n),Pe},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return Pe},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),i=n.indexOf(t);-1!==i&&(n.splice(i,1),e.className=n.join(" "))}else e.className=void 0;return Pe},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return ke(t["border-left-width"])+ke(t["border-right-width"])+ke(t["padding-left"])+ke(t["padding-right"])+ke(t.width)},getHeight:function(e){var t=getComputedStyle(e);return ke(t["border-top-width"])+ke(t["border-bottom-width"])+ke(t["padding-top"])+ke(t["padding-bottom"])+ke(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},Ie=function(e){function t(e,n){xe(this,t);var i=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=i;function r(){o.setValue(!o.__prev)}return i.__prev=i.getValue(),i.__checkbox=document.createElement("input"),i.__checkbox.setAttribute("type","checkbox"),Pe.bind(i.__checkbox,"change",r,!1),i.domElement.appendChild(i.__checkbox),i.updateDisplay(),i}return Le(t,e),Se(t,[{key:"setValue",value:function(e){var n=Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Oe),Fe=function(e){function t(e,n,i){xe(this,t);var o=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=i,a=o;if(o.__select=document.createElement("select"),fe.isArray(r)){var s={};fe.each(r,(function(e){s[e]=e})),r=s}return fe.each(r,(function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)})),o.updateDisplay(),Pe.bind(o.__select,"change",(function(){var e=this.options[this.selectedIndex].value;a.setValue(e)})),o.domElement.appendChild(o.__select),o}return Le(t,e),Se(t,[{key:"setValue",value:function(e){var n=Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return Pe.isActive(this.__select)?this:(this.__select.value=this.getValue(),Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(Oe),He=function(e){function t(e,n){xe(this,t);var i=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=i;function r(){o.setValue(o.__input.value)}function a(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}return i.__input=document.createElement("input"),i.__input.setAttribute("type","text"),Pe.bind(i.__input,"keyup",r),Pe.bind(i.__input,"change",r),Pe.bind(i.__input,"blur",a),Pe.bind(i.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),i.updateDisplay(),i.domElement.appendChild(i.__input),i}return Le(t,e),Se(t,[{key:"updateDisplay",value:function(){return Pe.isActive(this.__input)||(this.__input.value=this.getValue()),Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Oe);function Be(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var Ve=function(e){function t(e,n,i){xe(this,t);var o=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=i||{};return o.__min=r.min,o.__max=r.max,o.__step=r.step,fe.isUndefined(o.__step)?0===o.initialValue?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=Be(o.__impliedStep),o}return Le(t,e),Se(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!==0&&(n=Math.round(n/this.__step)*this.__step),Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=Be(e),this}}]),t}(Oe);function je(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}var ze=function(e){function t(e,n,i){xe(this,t);var o=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));o.__truncationSuspended=!1;var r=o,a=void 0;function s(){var e=parseFloat(r.__input.value);fe.isNaN(e)||r.setValue(e)}function l(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())}function c(){l()}function u(e){var t=a-e.clientY;r.setValue(r.getValue()+t*r.__impliedStep),a=e.clientY}function d(){Pe.unbind(window,"mousemove",u),Pe.unbind(window,"mouseup",d),l()}function h(e){Pe.bind(window,"mousemove",u),Pe.bind(window,"mouseup",d),a=e.clientY}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),Pe.bind(o.__input,"change",s),Pe.bind(o.__input,"blur",c),Pe.bind(o.__input,"mousedown",h),Pe.bind(o.__input,"keydown",(function(e){13===e.keyCode&&(r.__truncationSuspended=!0,this.blur(),r.__truncationSuspended=!1,l())})),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return Le(t,e),Se(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():je(this.getValue(),this.__precision),Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Ve);function Ue(e,t,n,i,o){return i+(e-t)/(n-t)*(o-i)}var Ge=function(e){function t(e,n,i,o,r){xe(this,t);var a=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:i,max:o,step:r})),s=a;function l(e){document.activeElement.blur(),Pe.bind(window,"mousemove",c),Pe.bind(window,"mouseup",u),c(e)}function c(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(Ue(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function u(){Pe.unbind(window,"mousemove",c),Pe.unbind(window,"mouseup",u),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function d(e){1===e.touches.length&&(Pe.bind(window,"touchmove",h),Pe.bind(window,"touchend",p),h(e))}function h(e){var t=e.touches[0].clientX,n=s.__background.getBoundingClientRect();s.setValue(Ue(t,n.left,n.right,s.__min,s.__max))}function p(){Pe.unbind(window,"touchmove",h),Pe.unbind(window,"touchend",p),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),Pe.bind(a.__background,"mousedown",l),Pe.bind(a.__background,"touchstart",d),Pe.addClass(a.__background,"slider"),Pe.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return Le(t,e),Se(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",Ee(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Ve),Xe=function(e){function t(e,n,i){xe(this,t);var o=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=o;return o.__button=document.createElement("div"),o.__button.innerHTML=void 0===i?"Fire":i,Pe.bind(o.__button,"click",(function(e){return e.preventDefault(),r.fire(),!1})),Pe.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return Le(t,e),Se(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(Oe),Ke=function(e){function t(e,n){xe(this,t);var i=Te(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));i.__color=new Ae(i.getValue()),i.__temp=new Ae(0);var o=i;i.domElement=document.createElement("div"),Pe.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",Pe.bind(i.__input,"keydown",(function(e){13===e.keyCode&&u.call(this)})),Pe.bind(i.__input,"blur",u),Pe.bind(i.__selector,"mousedown",(function(){Pe.addClass(this,"drag").bind(window,"mouseup",(function(){Pe.removeClass(o.__selector,"drag")}))})),Pe.bind(i.__selector,"touchstart",(function(){Pe.addClass(this,"drag").bind(window,"touchend",(function(){Pe.removeClass(o.__selector,"drag")}))}));var r=document.createElement("div");function a(e){h(e),Pe.bind(window,"mousemove",h),Pe.bind(window,"touchmove",h),Pe.bind(window,"mouseup",l),Pe.bind(window,"touchend",l)}function s(e){p(e),Pe.bind(window,"mousemove",p),Pe.bind(window,"touchmove",p),Pe.bind(window,"mouseup",c),Pe.bind(window,"touchend",c)}function l(){Pe.unbind(window,"mousemove",h),Pe.unbind(window,"touchmove",h),Pe.unbind(window,"mouseup",l),Pe.unbind(window,"touchend",l),d()}function c(){Pe.unbind(window,"mousemove",p),Pe.unbind(window,"touchmove",p),Pe.unbind(window,"mouseup",c),Pe.unbind(window,"touchend",c),d()}function u(){var e=_e(this.value);!1!==e?(o.__color.__state=e,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function d(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function h(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,i=n.clientX,r=n.clientY,a=(i-t.left)/(t.right-t.left),s=1-(r-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),a>1?a=1:a<0&&(a=0),o.__color.v=s,o.__color.s=a,o.setValue(o.__color.toOriginal()),!1}function p(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,i=n.clientY,r=1-(i-t.top)/(t.bottom-t.top);return r>1?r=1:r<0&&(r=0),o.__color.h=360*r,o.setValue(o.__color.toOriginal()),!1}return fe.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),fe.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),fe.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),fe.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),fe.extend(r.style,{width:"100%",height:"100%",background:"none"}),qe(r,"top","rgba(0,0,0,0)","#000"),fe.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),We(i.__hue_field),fe.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),Pe.bind(i.__saturation_field,"mousedown",a),Pe.bind(i.__saturation_field,"touchstart",a),Pe.bind(i.__field_knob,"mousedown",a),Pe.bind(i.__field_knob,"touchstart",a),Pe.bind(i.__hue_field,"mousedown",s),Pe.bind(i.__hue_field,"touchstart",s),i.__saturation_field.appendChild(r),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay(),i}return Le(t,e),Se(t,[{key:"updateDisplay",value:function(){var e=_e(this.getValue());if(!1!==e){var t=!1;fe.each(Ae.COMPONENTS,(function(n){if(!fe.isUndefined(e[n])&&!fe.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}}),this),t&&fe.extend(this.__color.__state,e)}fe.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,i=255-n;fe.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,qe(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),fe.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})}}]),t}(Oe),Ye=["-moz-","-o-","-webkit-","-ms-",""];function qe(e,t,n,i){e.style.background="",fe.each(Ye,(function(o){e.style.cssText+="background: "+o+"linear-gradient("+t+", "+n+" 0%, "+i+" 100%); "}))}function We(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var Je={load:function(e,t){var n=t||document,i=n.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,n.getElementsByTagName("head")[0].appendChild(i)},inject:function(e,t){var n=t||document,i=document.createElement("style");i.type="text/css",i.innerHTML=e;var o=n.getElementsByTagName("head")[0];try{o.appendChild(i)}catch(r){}}},Ze='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>',Qe=function(e,t){var n=e[t];return fe.isArray(arguments[2])||fe.isObject(arguments[2])?new Fe(e,t,arguments[2]):fe.isNumber(n)?fe.isNumber(arguments[2])&&fe.isNumber(arguments[3])?fe.isNumber(arguments[4])?new Ge(e,t,arguments[2],arguments[3],arguments[4]):new Ge(e,t,arguments[2],arguments[3]):fe.isNumber(arguments[4])?new ze(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new ze(e,t,{min:arguments[2],max:arguments[3]}):fe.isString(n)?new He(e,t):fe.isFunction(n)?new Xe(e,t,""):fe.isBoolean(n)?new Ie(e,t):null};function $e(e){setTimeout(e,1e3/60)}var et=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||$e,tt=function(){function e(){xe(this,e),this.backgroundElement=document.createElement("div"),fe.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),Pe.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),fe.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;Pe.bind(this.backgroundElement,"click",(function(){t.hide()}))}return Se(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),fe.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",Pe.unbind(e.domElement,"webkitTransitionEnd",t),Pe.unbind(e.domElement,"transitionend",t),Pe.unbind(e.domElement,"oTransitionEnd",t)};Pe.bind(this.domElement,"webkitTransitionEnd",t),Pe.bind(this.domElement,"transitionend",t),Pe.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-Pe.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-Pe.getHeight(this.domElement)/2+"px"}}]),e}(),nt=ue(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n");Je.inject(nt);var it="dg",ot=72,rt=20,at="Default",st=function(){try{return!!window.localStorage}catch(e){return!1}}(),lt=void 0,ct=!0,ut=void 0,dt=!1,ht=[],pt=function e(t){var n=this,i=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),Pe.addClass(this.domElement,it),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=fe.defaults(i,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),i=fe.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),fe.isUndefined(i.load)?i.load={preset:at}:i.preset&&(i.load.preset=i.preset),fe.isUndefined(i.parent)&&i.hideable&&ht.push(this),i.resizable=fe.isUndefined(i.parent)&&i.resizable,i.autoPlace&&fe.isUndefined(i.scrollable)&&(i.scrollable=!0);var o=st&&"true"===localStorage.getItem(yt(this,"isLocal")),r=void 0,a=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:i.load.preset},set:function(e){n.parent?n.getRoot().preset=e:i.load.preset=e,At(this),n.revert()}},width:{get:function(){return i.width},set:function(e){i.width=e,Lt(n,e)}},name:{get:function(){return i.name},set:function(e){i.name=e,a&&(a.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(t){i.closed=t,i.closed?Pe.addClass(n.__ul,e.CLASS_CLOSED):Pe.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return o},set:function(e){st&&(o=e,e?Pe.bind(window,"unload",r):Pe.unbind(window,"unload",r),localStorage.setItem(yt(n,"isLocal"),e))}}}),fe.isUndefined(i.parent)){if(this.closed=i.closed||!1,Pe.addClass(this.domElement,e.CLASS_MAIN),Pe.makeSelectable(this.domElement,!1),st&&o){n.useLocalStorage=!0;var s=localStorage.getItem(yt(this,"gui"));s&&(i.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,Pe.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),i.closeOnTop?(Pe.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(Pe.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),Pe.bind(this.__closeButton,"click",(function(){n.closed=!n.closed}))}else{void 0===i.closed&&(i.closed=!0);var l=document.createTextNode(i.name);Pe.addClass(l,"controller-name"),a=ft(n,l);var c=function(e){return e.preventDefault(),n.closed=!n.closed,!1};Pe.addClass(this.__ul,e.CLASS_CLOSED),Pe.addClass(a,"title"),Pe.bind(a,"click",c),i.closed||(this.closed=!1)}function u(){var e=n.getRoot();e.width+=1,fe.defer((function(){e.width-=1}))}i.autoPlace&&(fe.isUndefined(i.parent)&&(ct&&(ut=document.createElement("div"),Pe.addClass(ut,it),Pe.addClass(ut,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(ut),ct=!1),ut.appendChild(this.domElement),Pe.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||Lt(n,i.width)),this.__resizeHandler=function(){n.onResizeDebounced()},Pe.bind(window,"resize",this.__resizeHandler),Pe.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),Pe.bind(this.__ul,"transitionend",this.__resizeHandler),Pe.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&Et(this),r=function(){st&&"true"===localStorage.getItem(yt(n,"isLocal"))&&localStorage.setItem(yt(n,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=r,i.parent||u()};function ft(e,t,n){var i=document.createElement("li");return t&&i.appendChild(t),n?e.__ul.insertBefore(i,n):e.__ul.appendChild(i),e.onResize(),i}function mt(e){Pe.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&Pe.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function gt(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function vt(e,t,n){if(n.__li=t,n.__gui=e,fe.extend(n,{options:function(t){if(arguments.length>1){var i=n.__li.nextElementSibling;return n.remove(),bt(e,n.object,n.property,{before:i,factoryArgs:[fe.toArray(arguments)]})}if(fe.isArray(t)||fe.isObject(t)){var o=n.__li.nextElementSibling;return n.remove(),bt(e,n.object,n.property,{before:o,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof Ge){var i=new ze(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});fe.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=n[e],o=i[e];n[e]=i[e]=function(){var e=Array.prototype.slice.call(arguments);return o.apply(i,e),t.apply(n,e)}})),Pe.addClass(t,"has-slider"),n.domElement.insertBefore(i.domElement,n.domElement.firstElementChild)}else if(n instanceof ze){var o=function(t){if(fe.isNumber(n.__min)&&fe.isNumber(n.__max)){var i=n.__li.firstElementChild.firstElementChild.innerHTML,o=n.__gui.__listening.indexOf(n)>-1;n.remove();var r=bt(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return r.name(i),o&&r.listen(),r}return t};n.min=fe.compose(o,n.min),n.max=fe.compose(o,n.max)}else n instanceof Ie?(Pe.bind(t,"click",(function(){Pe.fakeEvent(n.__checkbox,"click")})),Pe.bind(n.__checkbox,"click",(function(e){e.stopPropagation()}))):n instanceof Xe?(Pe.bind(t,"click",(function(){Pe.fakeEvent(n.__button,"click")})),Pe.bind(t,"mouseover",(function(){Pe.addClass(n.__button,"hover")})),Pe.bind(t,"mouseout",(function(){Pe.removeClass(n.__button,"hover")}))):n instanceof Ke&&(Pe.addClass(t,"color"),n.updateDisplay=fe.compose((function(e){return t.style.borderLeftColor=n.__color.toString(),e}),n.updateDisplay),n.updateDisplay());n.setValue=fe.compose((function(t){return e.getRoot().__preset_select&&n.isModified()&&gt(e.getRoot(),!0),t}),n.setValue)}function _t(e,t){var n=e.getRoot(),i=n.__rememberedObjects.indexOf(t.object);if(-1!==i){var o=n.__rememberedObjectIndecesToControllers[i];if(void 0===o&&(o={},n.__rememberedObjectIndecesToControllers[i]=o),o[t.property]=t,n.load&&n.load.remembered){var r=n.load.remembered,a=void 0;if(r[e.preset])a=r[e.preset];else{if(!r[at])return;a=r[at]}if(a[i]&&void 0!==a[i][t.property]){var s=a[i][t.property];t.initialValue=s,t.setValue(s)}}}}function bt(e,t,n,i){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var o=void 0;if(i.color)o=new Ke(t,n);else{var r=[t,n].concat(i.factoryArgs);o=Qe.apply(e,r)}i.before instanceof Oe&&(i.before=i.before.__li),_t(e,o),Pe.addClass(o.domElement,"c");var a=document.createElement("span");Pe.addClass(a,"property-name"),a.innerHTML=o.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(o.domElement);var l=ft(e,s,i.before);return Pe.addClass(l,pt.CLASS_CONTROLLER_ROW),o instanceof Ke?Pe.addClass(l,"color"):Pe.addClass(l,we(o.getValue())),vt(e,l,o),e.__controllers.push(o),o}function yt(e,t){return document.location.href+"."+t}function wt(e,t,n){var i=document.createElement("option");i.innerHTML=t,i.value=t,e.__preset_select.appendChild(i),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function xt(e,t){t.style.display=e.useLocalStorage?"block":"none"}function St(e){var t=e.__save_row=document.createElement("li");Pe.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),Pe.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",Pe.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",Pe.addClass(i,"button"),Pe.addClass(i,"save");var o=document.createElement("span");o.innerHTML="New",Pe.addClass(o,"button"),Pe.addClass(o,"save-as");var r=document.createElement("span");r.innerHTML="Revert",Pe.addClass(r,"button"),Pe.addClass(r,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?fe.each(e.load.remembered,(function(t,n){wt(e,n,n===e.preset)})):wt(e,at,!1),Pe.bind(a,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(a),t.appendChild(n),t.appendChild(i),t.appendChild(o),t.appendChild(r),st){var s=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage"),c=document.getElementById("dg-save-locally");c.style.display="block","true"===localStorage.getItem(yt(e,"isLocal"))&&l.setAttribute("checked","checked"),xt(e,s),Pe.bind(l,"change",(function(){e.useLocalStorage=!e.useLocalStorage,xt(e,s)}))}var u=document.getElementById("dg-new-constructor");Pe.bind(u,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||lt.hide()})),Pe.bind(n,"click",(function(){u.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),lt.show(),u.focus(),u.select()})),Pe.bind(i,"click",(function(){e.save()})),Pe.bind(o,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),Pe.bind(r,"click",(function(){e.revert()}))}function Et(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function i(){Pe.removeClass(e.__closeButton,pt.CLASS_DRAG),Pe.unbind(window,"mousemove",n),Pe.unbind(window,"mouseup",i)}function o(o){return o.preventDefault(),t=o.clientX,Pe.addClass(e.__closeButton,pt.CLASS_DRAG),Pe.bind(window,"mousemove",n),Pe.bind(window,"mouseup",i),!1}e.__resize_handle=document.createElement("div"),fe.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),Pe.bind(e.__resize_handle,"mousedown",o),Pe.bind(e.__closeButton,"mousedown",o),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function Lt(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function Tt(e,t){var n={};return fe.each(e.__rememberedObjects,(function(i,o){var r={},a=e.__rememberedObjectIndecesToControllers[o];fe.each(a,(function(e,n){r[n]=t?e.initialValue:e.getValue()})),n[o]=r})),n}function At(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}function Rt(e){0!==e.length&&et.call(window,(function(){Rt(e)})),fe.each(e,(function(e){e.updateDisplay()}))}pt.toggleHide=function(){dt=!dt,fe.each(ht,(function(e){e.domElement.style.display=dt?"none":""}))},pt.CLASS_AUTO_PLACE="a",pt.CLASS_AUTO_PLACE_CONTAINER="ac",pt.CLASS_MAIN="main",pt.CLASS_CONTROLLER_ROW="cr",pt.CLASS_TOO_TALL="taller-than-window",pt.CLASS_CLOSED="closed",pt.CLASS_CLOSE_BUTTON="close-button",pt.CLASS_CLOSE_TOP="close-top",pt.CLASS_CLOSE_BOTTOM="close-bottom",pt.CLASS_DRAG="drag",pt.DEFAULT_WIDTH=245,pt.TEXT_CLOSED="Close Controls",pt.TEXT_OPEN="Open Controls",pt._keydownHandler=function(e){"text"===document.activeElement.type||e.which!==ot&&e.keyCode!==ot||pt.toggleHide()},Pe.bind(window,"keydown",pt._keydownHandler,!1),fe.extend(pt.prototype,{add:function(e,t){return bt(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return bt(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;fe.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&ut.removeChild(this.domElement);var e=this;fe.each(this.__folders,(function(t){e.removeFolder(t)})),Pe.unbind(window,"keydown",pt._keydownHandler,!1),mt(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new pt(t);this.__folders[e]=n;var i=ft(this,n.domElement);return Pe.addClass(i,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],mt(e);var t=this;fe.each(e.__folders,(function(t){e.removeFolder(t)})),fe.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=Pe.getOffset(e.__ul).top,n=0;fe.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(n+=Pe.getHeight(t))})),window.innerHeight-t-rt<n?(Pe.addClass(e.domElement,pt.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-rt+"px"):(Pe.removeClass(e.domElement,pt.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&fe.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:fe.debounce((function(){this.onResize()}),50),remember:function(){if(fe.isUndefined(lt)&&(lt=new tt,lt.domElement.innerHTML=Ze),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;fe.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&St(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&Lt(this,this.width)},getRoot:function(){var e=this;while(e.parent)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=Tt(this)),e.folders={},fe.each(this.__folders,(function(t,n){e.folders[n]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Tt(this),gt(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[at]=Tt(this,!0)),this.load.remembered[e]=Tt(this),this.preset=e,wt(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){fe.each(this.__controllers,(function(t){this.getRoot().load.remembered?_t(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),fe.each(this.__folders,(function(e){e.revert(e)})),e||gt(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&Rt(this.__listening)},updateDisplay:function(){fe.each(this.__controllers,(function(e){e.updateDisplay()})),fe.each(this.__folders,(function(e){e.updateDisplay()}))}});var Nt=pt,Ot=function(){function e(t,n,i){Object(a["a"])(this,e),this.gltfScene=n.scene,this.time=0,this.debug=!1,this.isMobile=le(),this.envRotation=0,this.envRotationFromPanel=new l["N"],this.envRotationMat={value:(new l["N"]).makeRotationY(this.envRotation)},this.cameraRotationMatrix=new l["N"],this.invCameraQuaternion=new l["db"],this.oringinCameraMatrix=new l["N"],this.envBrightness={value:1},this.renderer=t.renderer,this.scene=t.scene,this.camera=t.camera,this.container=t.container,this.width=t.width,this.height=t.height,this.callBack=i,this.control=new u(this.camera,this.container),this.initScene()}return Object(s["a"])(e,[{key:"loadEnvMap",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$[0],t="".concat(Q).concat(e,".zip");return(new I).loadPackage(t)}},{key:"loadSunLight",value:function(e){this.sunLight||(this.sunLight=new l["l"](16777215,1)),this.sunLight.position.copy(e.position),this.sunLight.castShadow=!0,this.scene.add(this.sunLight)}},{key:"loadBackground",value:function(e,t){this.background?(this.background.material.uniforms.envMap.value=e.cubeTexture,this.background.material.uniforms.uEnvironmentSize.value=t):(this.background=new Z({envMap:e.cubeTexture,uBGEnvironmentSize:t,uEnvBrightness:this.envBrightness,debug:this.debug},500),this.background.material.uniforms.uEnvironmentTransform=this.envRotationMat)}},{key:"updateEnvMap",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(t,n){var i,o,r,a,s,l,c,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("updateEnvMap: ",t),e.next=3,this.loadEnvMap(t);case 3:i=e.sent,o=i.cubeMapEnv,r=i.backgroundEnv,a=i.uEnvironmentSphericalHarmonics,s=i.uEnvironmentLodRange,l=i.uEnvironmentSize,c=i.uBGEnvironmentSize,u=i.sunlightInfo,this.loadSunLight(u),this.sunLightStartPos=this.sunLight.position.clone(),this.loadBackground(r,c),this.gltfScene.traverse((function(e){e.isMesh&&(e.material.uniforms.envMap.value=o.cubeTexture,e.material.uniforms["uEnvironmentSphericalHarmonics"]={value:a},e.material.uniforms["uEnvironmentLodRange"]={value:s},e.material.uniforms["uEnvironmentSize"]={value:l},e.material.needsUpdate=!0)})),"function"==typeof n&&n();case 10:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"initScene",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,n,i,o,r,a,s,c,u,d,h,p,f,m=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.loadEnvMap();case 2:t=e.sent,n=t.cubeMapEnv,i=t.backgroundEnv,o=t.uEnvironmentSphericalHarmonics,r=t.uEnvironmentLodRange,a=t.uEnvironmentSize,s=t.uBGEnvironmentSize,c=t.uIntegrateBRDF,u=t.sunlightInfo,d=this.scene,h=this.camera,this.loadSunLight(u),this.loadBackground(i,s),h.add(this.background),d.add(h),p=this.gltfScene,d.add(p),this.adjustFactorFromBox(p),f=this.shadowDepthRange=new l["xb"](this.sunLight.shadow.camera.near,this.sunLight.shadow.camera.far),p.traverse((function(e){e.isMesh&&(e.material.envMap=n.cubeTexture,e.material=new Y(e,{isMobile:m.isMobile,shadowDepthRange:f,uEnvironmentSphericalHarmonics:o,uEnvironmentLodRange:r,uEnvironmentSize:a,uIntegrateBRDF:c}),e.material.uniforms.uEnvironmentTransform=m.envRotationMat,e.material.uniforms.uEnvBrightness=m.envBrightness,e.castShadow=!0,e.receiveShadow=!0,e.material.uniforms.uEnableIBL=m.enableIBL,e.material.uniforms.uEnableLight=m.enableLight)})),this.initEvent(),this.initGUI(),"function"===typeof this.callBack&&this.callBack();case 17:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"adjustFactorFromBox",value:function(e){var t=this.box=(new l["c"]).setFromObject(e),n=t.getSize(new l["yb"]),i=Math.max(n.x,n.y,n.z);if(i<100){var o=100/i;e.scale.setScalar(o)}t=this.box=(new l["c"]).setFromObject(e);var r=t.getCenter(new l["yb"]);if(e.position.sub(r),this.debug){var a=new l["d"](e,16776960);this.scene.add(a)}oe(this.camera,e,this.control,2),this.background.setSize(this.camera.far),re(this.sunLight,this.scene,e,this.debug),this.sunLightStartPos=this.sunLight.position.clone()}},{key:"initEvent",value:function(){var e=this,t={x:0};window.addEventListener("mousemove",(function(n){var i=n.which||n.button;if(n.altKey&&i){n.stopPropagation();var o=n.clientX-t.x;e.envRotation+=.01*o}t.x=n.clientX}),!0)}},{key:"initGUI",value:function(){var e=this,t=new Nt,n=this.gltfScene,i=this.guiParams={enableIBL:!!K.ENABLE_IBL,enableLight:!!K.ENABLE_LIGHT,envRotation:this.envRotation,envBrightness:this.envBrightness.value,envMap:$[0],metalness:0,roughness:.5,diffuseEquation:ee[0],specularFresnelEquation:te[0],specularNDFEquation:ne[0],specularVisEquation:ie[0]},o=t.addFolder("PBR");o.add(i,"enableIBL").onChange((function(t){e.guiParams.enableIBL=t,e.reCompileShader()})),o.add(i,"enableLight").name("enableSunLight").onChange((function(t){e.guiParams.enableLight=t,e.reCompileShader()})),o.add(i,"envMap",$).onChange((function(t){document.querySelector("#wrapper").classList.add("isLoading"),e.updateEnvMap(t,(function(){document.querySelector("#wrapper").classList.remove("isLoading")}))})),o.add(i,"envRotation",-Math.PI,Math.PI).step(.1).onChange((function(t){e.envRotation=t})),o.add(i,"envBrightness",0,2).step(.1).onChange((function(t){e.envBrightness.value=t})),o.add(i,"metalness",0,1).step(.01).onChange((function(e){n.traverse((function(t){t.isMesh&&(t.material.uniforms.metalness.value=e)}))})),o.add(i,"roughness",0,1).step(.01).onChange((function(e){n.traverse((function(t){t.isMesh&&(t.material.uniforms.roughness.value=e)}))})),o.open();var r=t.addFolder("Equations");r.add(i,"diffuseEquation",ee).name("diffuse").onChange((function(t){e.guiParams.diffuseEquation=t,e.reCompileShader()})),r.add(i,"specularFresnelEquation",te).name("fresnel").onChange((function(t){e.guiParams.specularFresnelEquation=t,e.reCompileShader()})),r.add(i,"specularNDFEquation",ne).name("NDF").onChange((function(t){e.guiParams.specularNDFEquation=t,e.reCompileShader()})),r.add(i,"specularVisEquation",ie).name("geometry").onChange((function(t){e.guiParams.specularVisEquation=t,e.reCompileShader()})),r.open()}},{key:"getDefinesFromGUI",value:function(){var e={},t=this.guiParams;return t.enableIBL&&(e.ENABLE_IBL=1),t.enableLight&&(e.ENABLE_LIGHT=1),e["DIFFUSE_".concat(t.diffuseEquation.toUpperCase())]=1,e["F_".concat(t.specularFresnelEquation.toUpperCase())]=1,e["NDF_".concat(t.specularNDFEquation.toUpperCase())]=1,e["V_".concat(t.specularVisEquation.toUpperCase())]=1,e}},{key:"reCompileShader",value:function(){var e=this.getDefinesFromGUI();this.gltfScene.traverse((function(t){t.isMesh&&t.material&&(t.material.defines=e,t.material.needsUpdate=!0)}))}},{key:"syncEnvTransform",value:function(){this.invCameraQuaternion.copy(this.camera.quaternion).conjugate(),this.cameraRotationMatrix.makeRotationFromQuaternion(this.invCameraQuaternion),this.oringinCameraMatrix.extractRotation(this.camera.matrixWorld)}},{key:"updateEnvironmentRotation",value:function(e){this.envRotationFromPanel.makeRotationY(e),this.envRotationMat.value.multiplyMatrices(this.cameraRotationMatrix,this.envRotationFromPanel);var t=this.sunLightStartPos.clone();t.applyMatrix4(this.envRotationMat.value).applyMatrix4(this.oringinCameraMatrix),this.sunLight.position.copy(t)}},{key:"update",value:function(){this.syncEnvTransform(),this.updateEnvironmentRotation(this.envRotation),this.renderer.render(this.scene,this.camera)}}]),e}(),Mt=function(){function e(t,n,i){Object(a["a"])(this,e),this.container=t,this.time=0,this.width=ae(t),this.height=se(t);var o=this.camera=new l["Y"](45,this.width/this.height,.1,1e3);o.position.set(0,0,10);var r=this.renderer=new l["Bb"]({antialias:!1});r.domElement.id="canvasWebGL",r.setPixelRatio(window.devicePixelRatio),r.setSize(this.width,this.height),r.gammaFactor=2.2,r.setClearColor(16777215,1),r.shadowMap.enabled=!0,t.appendChild(r.domElement),this.initScene(n,i),this.initEvents()}return Object(s["a"])(e,[{key:"initScene",value:function(e,t){var n=this;this.scene=new l["ib"],this.modelViewer=new Ot(this,e,(function(){n.loaded=!0,n.onWindowResize(),"function"===typeof t&&t()})),this.animete()}},{key:"initEvents",value:function(){window.addEventListener("resize",this.onWindowResize.bind(this),!1)}},{key:"onWindowResize",value:function(){this.width=ae(this.container),this.height=se(this.container),this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height)}},{key:"animete",value:function(){this.loaded&&this.modelViewer.update(),requestAnimationFrame(this.animete.bind(this))}}]),e}(),Ct=(n("a630"),n("3835")),Dt=(n("4e82"),n("b420"),n("38cf"),n("fd87"),n("8b09"),n("84c3"),n("fb2c"),function(){function e(e){l["F"].call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(l["F"].prototype),{constructor:e,load:function(e,t,n,i){var o,r=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:l["G"].extractUrlBase(e),r.manager.itemStart(e);var a=function(t){i?i(t):console.error(t),r.manager.itemError(e),r.manager.itemEnd(e)},s=new l["p"](r.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),"use-credentials"===r.crossOrigin&&s.setWithCredentials(!0),s.load(e,(function(n){try{r.parse(n,o,(function(n){t(n),r.manager.itemEnd(e)}),a)}catch(i){a(i)}}),n,a)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,s,c){var p,g={};if("string"===typeof e)p=e;else{var v=l["G"].decodeText(new Uint8Array(e,0,4));if(v===a){try{g[n.KHR_BINARY_GLTF]=new u(e)}catch(S){return void(c&&c(S))}p=g[n.KHR_BINARY_GLTF].content}else p=l["G"].decodeText(new Uint8Array(e))}var _=JSON.parse(p);if(void 0===_.asset||_.asset.version[0]<2)c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(_.extensionsUsed)for(var b=0;b<_.extensionsUsed.length;++b){var y=_.extensionsUsed[b],w=_.extensionsRequired||[];switch(y){case n.KHR_LIGHTS_PUNCTUAL:g[y]=new o(_);break;case n.KHR_MATERIALS_UNLIT:g[y]=new r;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:g[y]=new f;break;case n.KHR_DRACO_MESH_COMPRESSION:g[y]=new d(_,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:g[y]=new i(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:g[y]=new h;break;case n.KHR_MESH_QUANTIZATION:g[y]=new m;break;default:w.indexOf(y)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+y+'".')}}var x=new P(_,g,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});x.parse(s,c)}}});var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function i(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=e}function o(e){this.name=n.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function r(){this.name=n.KHR_MATERIALS_UNLIT}o.prototype.loadLight=function(e){var t,n=this.lightDefs[e],i=new l["i"](16777215);void 0!==n.color&&i.fromArray(n.color);var o=void 0!==n.range?n.range:0;switch(n.type){case"directional":t=new l["l"](i),t.target.position.set(0,0,-1),t.add(t.target);break;case"point":t=new l["Z"](i),t.distance=o;break;case"spot":t=new l["pb"](i),t.distance=o,n.spot=n.spot||{},n.spot.innerConeAngle=void 0!==n.spot.innerConeAngle?n.spot.innerConeAngle:0,n.spot.outerConeAngle=void 0!==n.spot.outerConeAngle?n.spot.outerConeAngle:Math.PI/4,t.angle=n.spot.outerConeAngle,t.penumbra=1-n.spot.innerConeAngle/n.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+n.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==n.intensity&&(t.intensity=n.intensity),t.name=n.name||"light_"+e,Promise.resolve(t)},r.prototype.getMaterialType=function(){return l["P"]},r.prototype.extendParams=function(e,t,n){var i=[];e.color=new l["i"](1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var r=o.baseColorFactor;e.color.fromArray(r),e.opacity=r[3]}void 0!==o.baseColorTexture&&i.push(n.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(i)};var a="glTF",s=12,c={JSON:1313821514,BIN:5130562};function u(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,s);if(this.header={magic:l["G"].decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==a)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");var i=new DataView(e,s),o=0;while(o<i.byteLength){var r=i.getUint32(o,!0);o+=4;var u=i.getUint32(o,!0);if(o+=4,u===c.JSON){var d=new Uint8Array(e,s+o,r);this.content=l["G"].decodeText(d)}else if(u===c.BIN){var h=s+o;this.body=e.slice(h,h+r)}o+=r}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function d(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function h(){this.name=n.KHR_TEXTURE_TRANSFORM}function p(e){l["Q"].call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),i=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),r=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),a={specular:{value:(new l["i"]).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(e){for(var s in a)e.uniforms[s]=a[s];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",n),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",i),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",o),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",r)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(e){a.specular.value=e}},specularMap:{get:function(){return a.specularMap.value},set:function(e){a.specularMap.value=e}},glossiness:{get:function(){return a.glossiness.value},set:function(e){a.glossiness.value=e}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(e){a.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function f(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return p},extendParams:function(e,t,n){var i=t.extensions[this.name];e.color=new l["i"](1,1,1),e.opacity=1;var o=[];if(Array.isArray(i.diffuseFactor)){var r=i.diffuseFactor;e.color.fromArray(r),e.opacity=r[3]}if(void 0!==i.diffuseTexture&&o.push(n.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new l["i"](0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new l["i"](1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var a=i.specularGlossinessTexture;o.push(n.assignTexture(e,"glossinessMap",a)),o.push(n.assignTexture(e,"specularMap",a))}return Promise.all(o)},createMaterial:function(e){var t=new p(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=l["rb"],e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function m(){this.name=n.KHR_MESH_QUANTIZATION}function g(e,t,n,i){l["u"].call(this,e,t,n,i)}d.prototype.decodePrimitive=function(e,t){var n=this.json,i=this.dracoLoader,o=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},s={},l={};for(var c in r){var u=x[c]||c.toLowerCase();a[u]=r[c]}for(c in e.attributes){u=x[c]||c.toLowerCase();if(void 0!==r[c]){var d=n.accessors[e.attributes[c]],h=_[d.componentType];l[u]=h,s[u]=!0===d.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){i.decodeDracoFile(e,(function(e){for(var n in e.attributes){var i=e.attributes[n],o=s[n];void 0!==o&&(i.normalized=o)}t(e)}),a,l)}))}))},h.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},p.prototype=Object.create(l["Q"].prototype),p.prototype.constructor=p,p.prototype.copy=function(e){return l["Q"].prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},g.prototype=Object.create(l["u"].prototype),g.prototype.constructor=g,g.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,o=e*i*3+i,r=0;r!==i;r++)t[r]=n[o+r];return t},g.prototype.beforeStart_=g.prototype.copySampleValue_,g.prototype.afterEnd_=g.prototype.copySampleValue_,g.prototype.interpolate_=function(e,t,n,i){for(var o=this.resultBuffer,r=this.sampleValues,a=this.valueSize,s=2*a,l=3*a,c=i-t,u=(n-t)/c,d=u*u,h=d*u,p=e*l,f=p-l,m=-2*h+3*d,g=h-d,v=1-m,_=g-d+u,b=0;b!==a;b++){var y=r[f+b+a],w=r[f+b+s]*c,x=r[p+b+a],S=r[p+b]*c;o[b]=v*y+_*w+m*x+g*S}return o};var v={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},_={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},b={9728:l["S"],9729:l["B"],9984:l["U"],9985:l["E"],9986:l["T"],9987:l["D"]},y={33071:l["h"],33648:l["R"],10497:l["hb"]},w={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},x={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},S={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},E={CUBICSPLINE:void 0,LINEAR:l["w"],STEP:l["v"]},L={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"},T={"image/png":l["fb"],"image/jpeg":l["gb"]};function A(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function R(e){return void 0===e["DefaultMaterial"]&&(e["DefaultMaterial"]=new l["Q"]({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:l["q"]})),e["DefaultMaterial"]}function N(e,t,n){for(var i in n.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=n.extensions[i])}function O(e,t){void 0!==t.extras&&("object"===Object(ce["a"])(t.extras)?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function M(e,t,n){for(var i=!1,o=!1,r=0,a=t.length;r<a;r++){var s=t[r];if(void 0!==s.POSITION&&(i=!0),void 0!==s.NORMAL&&(o=!0),i&&o)break}if(!i&&!o)return Promise.resolve(e);var l=[],c=[];for(r=0,a=t.length;r<a;r++){s=t[r];if(i){var u=void 0!==s.POSITION?n.getDependency("accessor",s.POSITION):e.attributes.position;l.push(u)}if(o){u=void 0!==s.NORMAL?n.getDependency("accessor",s.NORMAL):e.attributes.normal;c.push(u)}}return Promise.all([Promise.all(l),Promise.all(c)]).then((function(t){var n=t[0],r=t[1];return i&&(e.morphAttributes.position=n),o&&(e.morphAttributes.normal=r),e.morphTargetsRelative=!0,e}))}function C(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,i=t.weights.length;n<i;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var o=t.extras.targetNames;if(e.morphTargetInfluences.length===o.length){e.morphTargetDictionary={};for(n=0,i=o.length;n<i;n++)e.morphTargetDictionary[o[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function D(e){var t,i=e.extensions&&e.extensions[n.KHR_DRACO_MESH_COMPRESSION];return t=i?"draco:"+i.bufferView+":"+i.indices+":"+k(i.attributes):e.indices+":"+k(e.attributes)+":"+e.mode,t}function k(e){for(var t="",n=Object.keys(e).sort(),i=0,o=n.length;i<o;i++)t+=n[i]+":"+e[n[i]]+";";return t}function P(e,n,i){this.json=e||{},this.extensions=n||{},this.options=i||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new l["sb"](this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new l["p"](this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function I(e,t,n){var i=t.attributes,o=new l["c"];if(void 0!==i.POSITION){var r=n.json.accessors[i.POSITION],a=r.min,s=r.max;if(void 0!==a&&void 0!==s){o.set(new l["yb"](a[0],a[1],a[2]),new l["yb"](s[0],s[1],s[2]));var c=t.targets;if(void 0!==c)for(var u=new l["yb"],d=0,h=c.length;d<h;d++){var p=c[d];if(void 0!==p.POSITION){r=n.json.accessors[p.POSITION],a=r.min,s=r.max;void 0!==a&&void 0!==s?(u.setX(Math.max(Math.abs(a[0]),Math.abs(s[0]))),u.setY(Math.max(Math.abs(a[1]),Math.abs(s[1]))),u.setZ(Math.max(Math.abs(a[2]),Math.abs(s[2]))),o.expandByVector(u)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}e.boundingBox=o;var f=new l["mb"];o.getCenter(f.center),f.radius=o.min.distanceTo(o.max)/2,e.boundingSphere=f}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function F(e,t,n){var i=t.attributes,o=[];function r(t,i){return n.getDependency("accessor",t).then((function(t){e.setAttribute(i,t)}))}for(var a in i){var s=x[a]||a.toLowerCase();s in e.attributes||o.push(r(i[a],s))}if(void 0!==t.indices&&!e.index){var l=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(l)}return O(e,t),I(e,t,n),Promise.all(o).then((function(){return void 0!==t.targets?M(e,t.targets,n):e}))}function H(e,t){var n=e.getIndex();if(null===n){var i=[],o=e.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var r=0;r<o.count;r++)i.push(r);e.setIndex(i),n=e.getIndex()}var a=n.count-2,s=[];if(t===l["tb"])for(r=1;r<=a;r++)s.push(n.getX(0)),s.push(n.getX(r)),s.push(n.getX(r+1));else for(r=0;r<a;r++)r%2===0?(s.push(n.getX(r)),s.push(n.getX(r+1)),s.push(n.getX(r+2))):(s.push(n.getX(r+2)),s.push(n.getX(r+1)),s.push(n.getX(r)));s.length/3!==a&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var c=e.clone();return c.setIndex(s),c}return P.prototype.parse=function(e,t){var n=this,i=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var r={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};N(o,r,i),O(r,i),e(r)}))["catch"](t)},P.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],i={},o={},r=0,a=t.length;r<a;r++)for(var s=t[r].joints,l=0,c=s.length;l<c;l++)e[s[l]].isBone=!0;for(var u=0,d=e.length;u<d;u++){var h=e[u];void 0!==h.mesh&&(void 0===i[h.mesh]&&(i[h.mesh]=o[h.mesh]=0),i[h.mesh]++,void 0!==h.skin&&(n[h.mesh].isSkinnedMesh=!0))}this.json.meshReferences=i,this.json.meshUses=o},P.prototype.getDependency=function(e,t){var i=e+":"+t,o=this.cache.get(i);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;case"light":o=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,o)}return o},P.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map((function(t,i){return n.getDependency(e,i)}))),this.cache.add(e,t)}return t},P.prototype.loadBuffer=function(e){var t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,n){i.load(A(t.uri,o.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},P.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+n)}))},P.prototype.loadAccessor=function(e){var t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);var o=[];return void 0!==i.bufferView?o.push(this.getDependency("bufferView",i.bufferView)):o.push(null),void 0!==i.sparse&&(o.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(o).then((function(e){var o,r,a=e[0],s=w[i.type],c=_[i.componentType],u=c.BYTES_PER_ELEMENT,d=u*s,h=i.byteOffset||0,p=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,f=!0===i.normalized;if(p&&p!==d){var m=Math.floor(h/p),g="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+m+":"+i.count,v=t.cache.get(g);v||(o=new c(a,m*p,i.count*p/u),v=new l["s"](o,p/u),t.cache.add(g,v)),r=new l["t"](v,s,h%p/u,f)}else o=null===a?new c(i.count*s):new c(a,h,i.count*s),r=new l["e"](o,s,f);if(void 0!==i.sparse){var b=w.SCALAR,y=_[i.sparse.indices.componentType],x=i.sparse.indices.byteOffset||0,S=i.sparse.values.byteOffset||0,E=new y(e[1],x,i.sparse.count*b),L=new c(e[2],S,i.sparse.count*s);null!==a&&(r=new l["e"](r.array.slice(),r.itemSize,r.normalized));for(var T=0,A=E.length;T<A;T++){var R=E[T];if(r.setX(R,L[T*s]),s>=2&&r.setY(R,L[T*s+1]),s>=3&&r.setZ(R,L[T*s+2]),s>=4&&r.setW(R,L[T*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return r}))},P.prototype.loadTexture=function(e){var t,i=this,o=this.json,r=this.options,a=this.textureLoader,s=window.URL||window.webkitURL,c=o.textures[e],u=c.extensions||{};t=u[n.MSFT_TEXTURE_DDS]?o.images[u[n.MSFT_TEXTURE_DDS].source]:o.images[c.source];var d=t.uri,h=!1;return void 0!==t.bufferView&&(d=i.getDependency("bufferView",t.bufferView).then((function(e){h=!0;var n=new Blob([e],{type:t.mimeType});return d=s.createObjectURL(n),d}))),Promise.resolve(d).then((function(e){var t=r.manager.getHandler(e);return t||(t=u[n.MSFT_TEXTURE_DDS]?i.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:a),new Promise((function(n,i){t.load(A(e,r.path),n,void 0,i)}))})).then((function(e){!0===h&&s.revokeObjectURL(d),e.flipY=!1,void 0!==c.name&&(e.name=c.name),t.mimeType in T&&(e.format=T[t.mimeType]);var n=o.samplers||{},i=n[c.sampler]||{};return e.magFilter=b[i.magFilter]||l["B"],e.minFilter=b[i.minFilter]||l["D"],e.wrapS=y[i.wrapS]||l["hb"],e.wrapT=y[i.wrapT]||l["hb"],e}))},P.prototype.assignTexture=function(e,t,i){var o=this;return this.getDependency("texture",i.index).then((function(r){if(!r.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":r.format=l["gb"];break}if(void 0===i.texCoord||0==i.texCoord||"aoMap"===t&&1==i.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),o.extensions[n.KHR_TEXTURE_TRANSFORM]){var a=void 0!==i.extensions?i.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;a&&(r=o.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(r,a))}e[t]=r}))},P.prototype.assignFinalMaterial=function(e){var t=e.geometry,n=e.material,i=(this.extensions,void 0!==t.attributes.tangent),o=void 0!==t.attributes.color,r=void 0===t.attributes.normal,a=!0===e.isSkinnedMesh,s=Object.keys(t.morphAttributes).length>0,c=s&&void 0!==t.morphAttributes.normal;if(e.isPoints){var u="PointsMaterial:"+n.uuid,d=this.cache.get(u);d||(d=new l["bb"],l["K"].prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(u,d)),n=d}else if(e.isLine){u="LineBasicMaterial:"+n.uuid;var h=this.cache.get(u);h||(h=new l["y"],l["K"].prototype.copy.call(h,n),h.color.copy(n.color),this.cache.add(u,h)),n=h}if(i||o||r||a||s){u="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),a&&(u+="skinning:"),i&&(u+="vertex-tangents:"),o&&(u+="vertex-colors:"),r&&(u+="flat-shading:"),s&&(u+="morph-targets:"),c&&(u+="morph-normals:");var p=this.cache.get(u);p||(p=n.clone(),a&&(p.skinning=!0),i&&(p.vertexTangents=!0),o&&(p.vertexColors=l["Ab"]),r&&(p.flatShading=!0),s&&(p.morphTargets=!0),c&&(p.morphNormals=!0),this.cache.add(u,p)),n=p}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",new l["e"](t.attributes.uv.array,2)),n.normalScale&&!i&&(n.normalScale.y=-n.normalScale.y),e.material=n},P.prototype.loadMaterial=function(e){var t,i=this,o=this.json,r=this.extensions,a=o.materials[e],s={},c=a.extensions||{},u=[];if(c[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var d=r[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=d.getMaterialType(),u.push(d.extendParams(s,a,i))}else if(c[n.KHR_MATERIALS_UNLIT]){var h=r[n.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),u.push(h.extendParams(s,a,i))}else{t=l["Q"];var f=a.pbrMetallicRoughness||{};if(s.color=new l["i"](1,1,1),s.opacity=1,Array.isArray(f.baseColorFactor)){var m=f.baseColorFactor;s.color.fromArray(m),s.opacity=m[3]}void 0!==f.baseColorTexture&&u.push(i.assignTexture(s,"map",f.baseColorTexture)),s.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,s.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(u.push(i.assignTexture(s,"metalnessMap",f.metallicRoughnessTexture)),u.push(i.assignTexture(s,"roughnessMap",f.metallicRoughnessTexture)))}!0===a.doubleSided&&(s.side=l["n"]);var g=a.alphaMode||L.OPAQUE;return g===L.BLEND?s.transparent=!0:(s.transparent=!1,g===L.MASK&&(s.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&t!==l["P"]&&(u.push(i.assignTexture(s,"normalMap",a.normalTexture)),s.normalScale=new l["xb"](1,1),void 0!==a.normalTexture.scale&&s.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)),void 0!==a.occlusionTexture&&t!==l["P"]&&(u.push(i.assignTexture(s,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(s.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&t!==l["P"]&&(s.emissive=(new l["i"]).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&t!==l["P"]&&u.push(i.assignTexture(s,"emissiveMap",a.emissiveTexture)),Promise.all(u).then((function(){var e;return e=t===p?r[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),void 0!==a.name&&(e.name=a.name),e.map&&(e.map.encoding=l["Cb"]),e.emissiveMap&&(e.emissiveMap.encoding=l["Cb"]),O(e,a),a.extensions&&N(r,e,a),e}))},P.prototype.loadGeometries=function(e){var t=this,i=this.extensions,o=this.primitiveCache;function r(e){return i[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return F(n,e,t)}))}for(var a=[],s=0,c=e.length;s<c;s++){var u,d=e[s],h=D(d),p=o[h];if(p)a.push(p.promise);else u=d.extensions&&d.extensions[n.KHR_DRACO_MESH_COMPRESSION]?r(d):F(new l["f"],d,t),o[h]={primitive:d,promise:u},a.push(u)}return Promise.all(a)},P.prototype.loadMesh=function(e){for(var t=this,n=this.json,i=n.meshes[e],o=i.primitives,r=[],a=0,s=o.length;a<s;a++){var c=void 0===o[a].material?R(this.cache):this.getDependency("material",o[a].material);r.push(c)}return r.push(t.loadGeometries(o)),Promise.all(r).then((function(n){for(var r=n.slice(0,n.length-1),a=n[n.length-1],s=[],c=0,u=a.length;c<u;c++){var d,h=a[c],p=o[c],f=r[c];if(p.mode===v.TRIANGLES||p.mode===v.TRIANGLE_STRIP||p.mode===v.TRIANGLE_FAN||void 0===p.mode)d=!0===i.isSkinnedMesh?new l["lb"](h,f):new l["O"](h,f),!0!==d.isSkinnedMesh||d.geometry.attributes.skinWeight.normalized||d.normalizeSkinWeights(),p.mode===v.TRIANGLE_STRIP?d.geometry=H(d.geometry,l["ub"]):p.mode===v.TRIANGLE_FAN&&(d.geometry=H(d.geometry,l["tb"]));else if(p.mode===v.LINES)d=new l["A"](h,f);else if(p.mode===v.LINE_STRIP)d=new l["x"](h,f);else if(p.mode===v.LINE_LOOP)d=new l["z"](h,f);else{if(p.mode!==v.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);d=new l["ab"](h,f)}Object.keys(d.geometry.morphAttributes).length>0&&C(d,i),d.name=i.name||"mesh_"+e,a.length>1&&(d.name+="_"+c),O(d,i),t.assignFinalMaterial(d),s.push(d)}if(1===s.length)return s[0];var m=new l["r"];for(c=0,u=s.length;c<u;c++)m.add(s[c]);return m}))},P.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new l["Y"](l["L"].radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new l["X"](i.xmag/-2,i.xmag/2,i.ymag/2,i.ymag/-2,i.znear,i.zfar)),void 0!==n.name&&(t.name=n.name),O(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},P.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},P.prototype.loadAnimation=function(e){for(var t=this.json,n=t.animations[e],i=[],o=[],r=[],a=[],s=[],c=0,u=n.channels.length;c<u;c++){var d=n.channels[c],h=n.samplers[d.sampler],p=d.target,f=void 0!==p.node?p.node:p.id,m=void 0!==n.parameters?n.parameters[h.input]:h.input,v=void 0!==n.parameters?n.parameters[h.output]:h.output;i.push(this.getDependency("node",f)),o.push(this.getDependency("accessor",m)),r.push(this.getDependency("accessor",v)),a.push(h),s.push(p)}return Promise.all([Promise.all(i),Promise.all(o),Promise.all(r),Promise.all(a),Promise.all(s)]).then((function(t){for(var i=t[0],o=t[1],r=t[2],a=t[3],s=t[4],c=[],u=0,d=i.length;u<d;u++){var h=i[u],p=o[u],f=r[u],m=a[u],v=s[u];if(void 0!==h){var _;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,S[v.path]){case S.weights:_=l["V"];break;case S.rotation:_=l["eb"];break;case S.position:case S.scale:default:_=l["zb"];break}var b=h.name?h.name:h.uuid,y=void 0!==m.interpolation?E[m.interpolation]:l["w"],w=[];S[v.path]===S.weights?h.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&w.push(e.name?e.name:e.uuid)})):w.push(b);var x=f.array;if(f.normalized){var L;if(x.constructor===Int8Array)L=1/127;else if(x.constructor===Uint8Array)L=1/255;else if(x.constructor==Int16Array)L=1/32767;else{if(x.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");L=1/65535}for(var T=new Float32Array(x.length),A=0,R=x.length;A<R;A++)T[A]=x[A]*L;x=T}for(A=0,R=w.length;A<R;A++){var N=new _(w[A]+"."+S[v.path],p.array,x,y);"CUBICSPLINE"===m.interpolation&&(N.createInterpolant=function(e){return new g(this.times,this.values,this.getValueSize()/3,e)},N.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(N)}}}var O=void 0!==n.name?n.name:"animation_"+e;return new l["a"](O,void 0,c)}))},P.prototype.loadNode=function(e){var t=this.json,i=this.extensions,o=this,r=t.meshReferences,a=t.meshUses,s=t.nodes[e];return function(){var e=[];return void 0!==s.mesh&&e.push(o.getDependency("mesh",s.mesh).then((function(e){var t;if(r[s.mesh]>1){var n=a[s.mesh]++;t=e.clone(),t.name+="_instance_"+n}else t=e;return void 0!==s.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=s.weights.length;t<n;t++)e.morphTargetInfluences[t]=s.weights[t]})),t}))),void 0!==s.camera&&e.push(o.getDependency("camera",s.camera)),s.extensions&&s.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[n.KHR_LIGHTS_PUNCTUAL].light&&e.push(o.getDependency("light",s.extensions[n.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e)}().then((function(e){var t;if(t=!0===s.isBone?new l["b"]:e.length>1?new l["r"]:1===e.length?e[0]:new l["W"],t!==e[0])for(var n=0,o=e.length;n<o;n++)t.add(e[n]);if(void 0!==s.name&&(t.userData.name=s.name,t.name=l["cb"].sanitizeNodeName(s.name)),O(t,s),s.extensions&&N(i,t,s),void 0!==s.matrix){var r=new l["N"];r.fromArray(s.matrix),t.applyMatrix4(r)}else void 0!==s.translation&&t.position.fromArray(s.translation),void 0!==s.rotation&&t.quaternion.fromArray(s.rotation),void 0!==s.scale&&t.scale.fromArray(s.scale);return t}))},P.prototype.loadScene=function(){function e(t,n,i,o){var r=i.nodes[t];return o.getDependency("node",t).then((function(e){return void 0===r.skin?e:o.getDependency("skin",r.skin).then((function(e){t=e;for(var n=[],i=0,r=t.joints.length;i<r;i++)n.push(o.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var i=[],o=[],r=0,a=n.length;r<a;r++){var s=n[r];if(s){i.push(s);var c=new l["N"];void 0!==t.inverseBindMatrices&&c.fromArray(t.inverseBindMatrices.array,16*r),o.push(c)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[r])}e.bind(new l["kb"](i,o),e.matrixWorld)}})),e}));var t})).then((function(t){n.add(t);var a=[];if(r.children)for(var s=r.children,l=0,c=s.length;l<c;l++){var u=s[l];a.push(e(u,t,i,o))}return Promise.all(a)}))}return function(t){var n=this.json,i=this.extensions,o=this.json.scenes[t],r=this,a=new l["ib"];void 0!==o.name&&(a.name=o.name),O(a,o),o.extensions&&N(i,a,o);for(var s=o.nodes||[],c=[],u=0,d=s.length;u<d;u++)c.push(e(s[u],a,n,r));return Promise.all(c).then((function(){return a}))}}(),e}()),kt=function(){function e(){Object(a["a"])(this,e)}return Object(s["a"])(e,[{key:"importGLTF",value:function(e){var t,n;Array.from(e).forEach((function(e){var i=Object(Ct["a"])(e,2),o=i[0],r=i[1];r.name.match(/\.(gltf|glb)$/)&&(t=r,n=o.replace(r.name,""))})),t||console.error("No .gltf or .glb asset found.");var i="string"===typeof t?t:URL.createObjectURL(t);return this.loadLocalGLTF(i,n,e)}},{key:"loadLocalGLTF",value:function(e,t,n){var i=l["G"].extractUrlBase(e);return new Promise((function(o,r){var a=new l["H"];a.setURLModifier((function(e,o){var r=t+e.replace(i,"").replace(/^(\.?\/)/,"");if(n.has(r)){var a=n.get(r),s=URL.createObjectURL(a);return c.push(s),s}return(o||"")+e}));var s=new Dt(a);s.setCrossOrigin("anonymous");var c=[];s.load(e,(function(e){o(e)}),void 0,r)}))}},{key:"loadGLTF",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"scene.gltf",n=new Dt;return n.setPath(e),new Promise((function(e){n.load(t,(function(t){e(t)}))}))}}]),e}(),Pt=n("8792"),It={name:"container",data:function(){return{openImportPage:!0}},mounted:function(){this.initEvent()},methods:{initScene:function(e){var t=document.querySelector("#canvasContainer");this.scene=new Mt(t,e,(function(){document.querySelector("#wrapper").classList.remove("isLoading")}))},initEvent:function(){var e=this,t=this,n=new kt,i=document.body.querySelector("#file-input"),o=document.body.querySelector(".dropzone"),r=new Pt["a"](o,i);r.on("drop",(function(i){var o=i.files;return n.importGLTF(o).then((function(n){e.initScene(n),t.openImportPage=!1}))}))},loadDefaultMode:function(){var e=this,t=new kt;this.openImportPage=!1,t.loadGLTF("./assets/models/damagedHelmet/").then((function(t){e.initScene(t)}))}}},Ft=It,Ht=(n("8aaa"),n("2877")),Bt=Object(Ht["a"])(Ft,o,r,!1,null,null,null),Vt=Bt.exports;new i["a"]({render:function(e){return e(Vt)}}).$mount("#container")},"8aaa":function(e,t,n){"use strict";var i=n("3468"),o=n.n(i);o.a}});
//# sourceMappingURL=app.122cc800.js.map